<!DOCTYPE html>
<html  lang="{{ lang }}-{{ lang|upper }}">
    <head>
        <!-- Global site tag (gtag.js) - Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-4050805-15"></script>
		<script>
		  window.dataLayer = window.dataLayer || [];
		  function gtag(){dataLayer.push(arguments);}
		  gtag('js', new Date());

		  gtag('config', 'UA-4050805-15');
		</script>
		{% block head %}
        <base href="/" />
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=8" />
        <title>{{title}}</title>
        <link rel="shortcut icon" href="favicon.ico" />
		<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon72.png" />
		<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon57.png" />
		<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon114.png" />
		<meta name="description" content="{{desc}}">
        <meta name="keywords" content="{{keywords}}" />

        <link rel="stylesheet" type="text/css" href="app/templates/assets/css/styl.css" />
        <link rel="stylesheet" type="text/css" href="app/templates/assets/js/jquery.alerts/jquery.alerts.css" />
		<script async custom-element="amp-ad" src="https://cdn.ampproject.org/v0/amp-ad-0.1.js"></script>
        {% endblock %}
		<style>
			#pogoda{background:url( {{ weaterGraphics|raw }} ) no-repeat; background-position: 10px 10px;}
			{% if mess > 0 %}
				#messAll{
					display:block;
				}
			{% endif %}
			{% if rap > 0 %}
				#rapAll{
					display:block;
				}
			{% endif %}
			{% if koperta == 1 %}
				#koperta{
					display:block;
				}
			{% endif %}
		</style>
	</head>
    {% if player.playerID %}
		<body onload="jsonLoad('/getchat/msg/world', {}, true, function(data) { $('#chatbox').html(data.response); $('#chatTab_world').addClass('current'); $('#sb_world ul').animate({ scrollTop : $('#sb_world ul').height() * 20 }, 'slow'); $('#chatTab_nation').removeClass('current'); $('#chatTab_private').removeClass('current'); $('#chatTab_world span').html(''); if (readCookie('chatSounds')) { $('input#isSoundOn').attr('checked', true); } }); return false;">
	{% else %}
		<body>
	{% endif %}
	    <div class="grid-test" id="ww-mapa" style="width: 100%; height: 100%; position: absolute; z-index: 8;"></div>
        <div id="popwindow_overlay"></div>
		<div id="popwindowWindow"></div>
        <div id="game_popwindow">
            <h1 class="popwindow_title"></h1>
            <div title="{{ constant('panel_gry3') }}" class="close"></div>
            <div class="popwindow_content"></div>
        </div>
		<div id="activeWindow">
			<div title="{{ constant('panel_gry3') }}" class="close"></div>
			<h1 class="windowTitle"></h1>
			<div class="windowBody">
			</div>
		</div>
		<div id="noweLeweMenu">
			<div id="faq_button" title="{{ constant('poradnik_no_active') }}" class="leweMenu" num="1">FAQ</div>
			<div id="listaJednostek" title="{{ constant('ingame1') }}" class="leweMenu" num="1">LJ</div>
			<div id="noweFabryki" title="{{ constant('hate_fabrica_no_active') }}" class="leweMenu factory" num="1">Fa</div>
			<div id="noweSztaby" title="{{ constant('hate_bars_no_active') }}" class="leweMenu">SZ</div>
			<div id="nowaKadra" title="{{ constant('fabryki_kadra') }}" class="leweMenu">Ka</div>
			<div title="{{ constant('hate_forum_no_active') }}" class="leweMenu forum" num="1">Fo<div id="koperta">N</div></div>
			<div id="nowySklep" title="{{ constant('hate_shop_no_active') }}" class="leweMenu">SK</div>
			<div id="noweUstawienia" num="1" title="{{ constant('hate_settings_no_active') }}" class="ustawienia leweMenu">Us</div>
			<div id="nowySamouczek" title="{{ constant('hate_schola_no_active') }}" class="leweMenu">Sa</div>
			<div id="noweWyloguj" title="{{ constant('panel_logout') }}" class="leweMenu">Wy</div>
			<div id="panelWyloguj"></div>
			{% if rank == "ADMIN" %}
				<div class="administrationNaw leweMenu" num="1" title="{{ constant('hate6') }}" class="leweMenu">Ad</div>
			{% endif %}
		</div>
		<div id="productionQueue"></div>
		<div id="noweGorneMenu">
			<div id="nowyNazwa">
				<div id="pagon" class="pagon" title="{{ player.stopien }}" style="background:url(app/templates/assets/images/pagony.png) {{ player.poziom }}px {{ player.pion }}px no-repeat;"></div><div class="podGrupa profil_button" style="width:65%;float:right;left:20%" num="{{ id }}" title="{{ constant('profil')|raw }}">{{ player.login }}
				{% if rank == "ADMIN" %}
					id= {{ player.playerID }}
				{% endif %}
				
				
				</div>
				<div id="pagon_info"><div class="srobka_left_up"></div>{{ constant('panel_gry2') }} {{ player.experience }} {{ constant('panel_gry20') }}<br>
					{{ infoPagon|raw }}
					{{ infoPoziom|raw }}
                    <div class="srobka_right_down"></div>
                    <div id="close_info" title="{{ constant('panel_gry3') }}"></div>
                </div>
				<a href="mapa"><div id="refreshMap" title="{{ constant('refreshMap') }}"></div></a>
				{{ damaged|raw }}
			</div>
			<div id="alarma" class="blink"></div>
			<div id="noweStatystyki">
				<div id="wt" class="podGrupa" title="ranking świata">{{ player.worldTop }}</div>
				<div id="gt" class="podGrupa" title="ranking Globalny gry Wichry Wojny">{{ player.globalTop }}</div>
				<div id="misje" title="Nowe misje!">{{ constant("nowe_misje") }}</div>
				<div class="buttonCity goToCoords" x="{{ coordX }}" y="{{  coordY }}" title="kliknij, a wyśrodkujesz mapę na swoim miescie">{{ constant("ingame2") }}</div>
				<div class="messageBox"></div>
				<div id="messAll">{{ mess }}</div>
				<div id="rapAll">{{ rap }}</div>
			</div>
			<div id="nowyDatownikGry">
				<div class="podGrupaBC">
					<strong>{{ world.WarDateM }} {{ world.WarDateY }}</strong> ( {{ world.WarTurn }} {{ constant("panel_tura") }} ) <span class="info" title="Trudność gry:<br> * :KADET ( Łatwy )<br>** :WOJAK ( lekko trudny )<br> *** :WETERAN ( trudny )">{% if world.hardGame == 1 %}*{% elseif world.hardGame == 2 %}**{% elseif world.hardGame == 3 %}***{% endif %}</span>
				</div>
				<div id="podgrupaDatownik">
					<div class="srobka_left_up"></div>
					{% if world.timing == 1 %}
						{{ constant("ingame3") }} {{ world.timeToUp }} {{ constant("comp_admin6") }}<br>
						{{ constant("ingame4") }} {{ world.timeClock }}
					{% else %}
						{{ infoTurn|raw }}
						{{ infoUp|raw }}
						<div id="zegarek">{{ constant("mess_gracz6") }}: <strong id="czas"/></strong></div>
					{% endif %}
					<div class="srobka_right_down"></div>
				</div>
			</div>
			<div id="nowyDatownikSponsor">
					{% if player.SponsorAccount > DateNow %}
						<div class="podGrupa sponsor" title="{{ constant('comp_account35') }}: {{ player.SponsorAccountDate }}">
							<div id="timerSP">{{ player.SponsorAccount }}</div>
						</div>
					{% else %}
						<div class="podGrupa sponsor">
							{{ constant("panel_gry13") }}
						</div>
					{% endif %}
			</div>
			<div id="licznikZloto">
				<div class="podGrupa bank" title="Twoje złoto"><div id="miniSztaba"></div><span>{{ player.gold }}</span></div>
			</div>
			<div class="podGrupa rawMaterials">
				{% if rawMaterials > 0 %}
					<div id="rawMaterials">{{ rawMaterials|round }}</div>
				{% else %}
					<div id="rawMaterials">Opracuj technologię Surowców</div>
				{% endif %}
			</div>
			<div id="licznikKasa">
				<div id="kasa" class="podGrupa" title="Twoje kredyty" style="text-align:left;"><div id="miniKasa"></div><span style="padding-left: 28px;">{{ ( player.softCurrency+player.PremiumCurrency) }}</span></div>
					{% if kasa_odbior > 0 %}
						<div id="finanse" title="sprawdź swoje finanse!"></div>
					{% else %}
						{% if world.timing > 0 %}
							<div id="timerK" title="{{ constant('ingame5') }}"></div>
						{% endif %}
					{% endif %}
			</div>
		</div>
		<div id="nowePraweMenu">
			<div id="pogoda">
				<div id="pogoda_opis">
                    <div class="srobka_left_up"></div>
                    {{ weaterDescription|raw }}
                    <div class="srobka_right_down"></div>
                </div>
			</div>
			<div id="pogoda_bg"></div>
				{% if promotion > 0 %}
					<div id="promocja_button">
						{{ constant("promocja_no_active")|raw }}
						<div id="timerP"></div>
					</div>					
				{% endif %}
				
				{% if questionnaire > 0 %}
					{{ questionnaire }}					
				{% endif %}
			<div id="tray" class="praweMenu" title="Twój zasobnik">Za</div>	
			<div id="przyciskRadio" class="praweMenu" title="{{ constant('radio_txt') }}">Ra</div>
			<div id="miniMap_open" class="praweMenu" title="{{ constant('hate_map_no_active') }}">Ma</div>
			{% if rank == "ADMIN" %}
				<div id="quest" class="praweMenu">Qu</div>
			{% endif %}
		</div>
		<div id="cityPlane">
			<div id="closeCity">Wróć na mapę</div>
				<div id="technologyBlock">
					<div id="developmentOffice">
						<div id="descript1">
						</div>
						<div id="buildUp1" class="buildUpTB" num="1">PRZYCISK ROZBUDUJ</div>
					</div>
					<div id="materialTechnology">
						<div id="descript2">
						</div>
						<div id="buildUp2" class="buildUpTB" num="2">PRZYCISK ROZBUDUJ</div>
					</div>	 
					<div id="optimizationStorage">
						<div id="descript3">
						</div>
						<div id="buildUp3"class="buildUpTB"  num="3">PRZYCISK ROZBUDUJ</div>
					</div>
					<div id="productionOptimization">
						<div id="descript4">
						</div>
						<div id="buildUp4" class="buildUpTB" num="4">PRZYCISK ROZBUDUJ</div>
					</div>
					<div id="materialsScience">
						<div id="descript5">
						</div>
						<div id="buildUp5" class="buildUpTB" num="5">PRZYCISK ROZBUDUJ</div>
					</div>
				</div>
		</div>
		
		<div id="sojusznicy">
			{{ sojusznicy|raw }}
		</div>
		<div id="upGold">
		</div>
		<div id="sponsorUnitList"><div id="piechota"></div><div id="lotnictwo"></div><div id="pancerne"></div><div id="flota"></div><div id="przeciwlotnicze"></div><div id="artyleria"></div><div id="content">{{ sponsorUnitsList|raw }}</div></div>
		 <!--koniec nowego interface -->
		 
        
		<div id="faq" class="popup_faq"></div>
		<div id="boxpopup_faq" class="box_faq">
			<div id="zamknij_faq"></div>
			<h1 class="windowTitle">{{ constant("wichrowe_faq") }}</h1>
			{{ constant("ingame6") }} ;)<br>
			<form id="searchAnswer">
				<input type="text" name="frazy" id="frazy" placeholder="{{ constant('ingame7') }}"/>
				<input type="button" id="faqForm" value="{{ constant('ingame8') }}"/>
			</form>
			<div id="simple-accordion"> 
				<h1 class="accordion_toggle" id="h1">{{ constant("jednostki") }}</h1>
					<div id="simple-accordion1" class="lista_pytan">
						 {% for daneFaq1 in faq1 %}
							<h1 class="vertical_accordion_toggle">1.{{ daneFaq1.num }}  {{ daneFaq1.pytanie|raw }}</h1>
							<div class="vertical_accordion_content">
								<p>
									{{ daneFaq1.odpowiedz|raw }}
								</p>  	
							</div>
						 {% endfor %}
					</div>
				<h1 class="accordion_toggle" id="h2">{{ constant("tury") }}</h1>
					<div id="simple-accordion2" class="lista_pytan">
						{% for daneFaq2 in faq2 %}
							<h1 class="vertical_accordion_toggle">2.{{ daneFaq2.num }}  {{ daneFaq2.pytanie|raw }}</h1>
							<div class="vertical_accordion_content">
								<p>
									{{ daneFaq2.odpowiedz|raw }}
								</p>  	
							</div>
						 {% endfor %}
					</div>
				<h1 class="accordion_toggle" id="h3">{{ constant("sponsor") }}</h1>
					<div id="simple-accordion3" class="lista_pytan">
						{% for daneFaq3 in faq3 %}
							<h1 class="vertical_accordion_toggle">3.{{ daneFaq3.num }}  {{ daneFaq3.pytanie|raw }}</h1>
							<div class="vertical_accordion_content">
								<p>
									{{ daneFaq3.odpowiedz|raw }}
								</p>  	
							</div>
						 {% endfor %}
					</div>
				<h1 class="accordion_toggle" id="h4">{{ constant("funkcje") }}</h1>
					<div id="simple-accordion4" class="lista_pytan">
						{% for daneFaq4 in faq4 %}
							<h1 class="vertical_accordion_toggle">4.{{ daneFaq4.num }}  {{ daneFaq4.pytanie|raw }}</h1>
							<div class="vertical_accordion_content">
								<p>
									{{ daneFaq4.odpowiedz|raw }}
								</p>  	
							</div>
						 {% endfor %}
					</div>
				<h1 class="accordion_toggle" id="h5">{{ constant("pieniadze") }}</h1>
					<div id="simple-accordion5" class="lista_pytan">
						{% for daneFaq5 in faq5 %}
							<h1 class="vertical_accordion_toggle">5.{{ daneFaq5.num }}  {{ daneFaq5.pytanie|raw }}</h1>
							<div class="vertical_accordion_content">
								<p>
									{{ daneFaq5.odpowiedz|raw }}
								</p>  	
							</div>
						 {% endfor %}
					</div>
				<h1 class="accordion_toggle" id="h6">{{ constant("rejestracja") }}</h1>
					<div id="simple-accordion6" class="lista_pytan">
						{% for daneFaq6 in faq6 %}
							<h1 class="vertical_accordion_toggle">6.{{ daneFaq6.num }}  {{ daneFaq6.pytanie|raw }}</h1>
							<div class="vertical_accordion_content">
								<p>
									{{ daneFaq6.odpowiedz|raw }}
								</p>  	
							</div>
						 {% endfor %}
					</div>
			</div>
		</div>
        <div class="content">
            <div id="main" style="z-index:10; position: relative;">
                {% block main %}
				<div id="radio">
					<div id="radio_txt">
						{{ constant("radio_txt") }}
					</div>
					<div id="radio_body">
						<ul class="nav">
							<li class="nav1">
								<a href="#tab1" id="chatTab_world" class="current" onclick="jsonLoad('/getchat/msg/world', {}, true, function(data) { $('#chatbox').html(data.response); $('#chatTab_world').addClass('current'); $('#sb_world ul').animate({ scrollTop : $('#sb_world ul').height() * 20 }, 'slow'); $('#chatTab_nation').removeClass('current'); $('#chatTab_private').removeClass('current'); $('#chatTab_world span').html(''); if (readCookie('chatSounds')) { $('input#isSoundOn').attr('checked', true); } }); return false;">{{ constant("mapa_radio1") }} <span></span></a>
							</li>
							<li class="nav2">
								<a href="#tab2" id="chatTab_nation" onclick="jsonLoad('/getchat/msg/nation', {}, true, function(data) { $('#chatbox').html(data.response); $('#chatTab_nation').addClass('current');$('#sb_nation ul').animate({ scrollTop : $('#sb_nation ul').height() * 20 }, 'slow'); $('#chatTab_world').removeClass('current'); $('#chatTab_private').removeClass('current'); $('#chatTab_nation span').html(''); if (readCookie('chatSounds')) { $('input#isSoundOn').attr('checked', true); } }); return false;">{{ constant("mapa_radio2") }} <span></span></a>
							</li>
							<li class="nav3">
								<a href="#tab3" id="chatTab_private" onclick="jsonLoad('/getchat/msg/private', {}, true, function(data) { $('#chatbox').html(data.response); $('#chatTab_private').addClass('current'); $('#sb_private ul').animate({ scrollTop : $('#sb_private ul').height() * 20 }, 'slow'); $('#chatTab_world').removeClass('current'); $('#chatTab_nation').removeClass('current'); $('#chatTab_private span').html(''); if (readCookie('chatSounds')) { $('input#isSoundOn').attr('checked', true); } }); return false;">{{ constant("mapa_radio3") }} <span></span></a>
							</li>
						</ul>
						<div id="chatbox">
						</div>
					</div>
				</div>
                {% endblock %}
                {% if printError %}
                <div id="alert_window"><div class="srobka_left_up"></div><div id="icon_alert"></div><p class="p_alert">{{ printError }}</p><div class="srobka_right_down"></div></div>
                {% endif %}
            </div>
			
            {% block footer %}
            <div id="coordsData"></div>
			<div id="sound_money"></div>
                {% endblock %}
		</div>
        <script type="text/javascript" src="app/templates/assets/js/jquery.js"></script>
        <script type="text/javascript" src="app/templates/assets/js/jquery.alerts/jquery.alerts.js"></script>
		<script type="text/javascript" src="app/templates/assets/js/accordion.js"></script>
		<script type="text/javascript" src="app/templates/assets/js/hovler.js"></script>
		<script type="text/javascript" src="app/templates/assets/js/jquery-confirm.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
		<script>
			function decodeHtml(value) {
				return $('<div/>').html(value).html();
			}
			/* ciastka */
			function createCookie(name, value, days) {
				if (days) {
					var date = new Date();
					date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
					var expires = "; expires=" + date.toGMTString();
				}
				else
					var expires = ";";
				document.cookie = name + "=" + escape(value) + expires + "; path=/";
			}
			function readCookie(name) {
				var nameEQ = name + "=";
				var ca = document.cookie.split(';');
				for (var i = 0; i < ca.length; i++) {
					var c = ca[i];
					while (c.charAt(0) == ' ')
						c = c.substring(1, c.length);
					if (c.indexOf(nameEQ) == 0)
						return unescape(c.substring(nameEQ.length, c.length));
				}
				return null;
			}
			function eraseCookie(name) {
				createCookie(name, "", -1);
			}
			/*
			 * Klasa odtwarza dzwięki podczas walki
			 */
			var soundAPI = {
				soundVolume: 0.5,
				soundHandle: [],
				soundFiles: null,
				init: function(soundFiles, loop)
				{
					$.each(soundFiles, function(index, value) {
						soundFiles[index] = 'app/templates/assets/sounds/'+value;
					
					});
					this.setSound('background', soundFiles, loop);
				},
				setSound: function(layerName, trackUrl, loop)
				{
					if (typeof soundAPI.soundHandle[layerName] !== 'object')
					{
						this.soundHandle[layerName] = new Howl({
							urls: trackUrl,
							autoplay: true,
							loop: loop,
							volume: 0.5
						});
					}
					else this.soundHandle[layerName].stop().play();

					this.checkVolume();
				},
				checkVolume: function(switchSound)
				{
					var isVolume = readCookie('SoundVolume');
					if (switchSound)
					{
						createCookie('SoundVolume', switchSound, 30);
						Howler.volume((switchSound/10));
						isVolume = switchSound;
					}
					else if(isVolume)
					{
						Howler.volume((isVolume/10));
					}
					else
					{
						createCookie('SoundVolume', 5, 30);
						Howler.volume((5/10));
						isVolume = 5;
					}
				},
				muteSounds: function()
				{
					createCookie('SoundVolume', 0, 30);
					Howler.mute();
				}
			}
			
			
			
			
			
			
			

/*Obiekt dostępny na całej stronie*/
var pageObj = {
    blockClick: false 
}

/*Obiekt z danymi gracza potrzebny w JS*/
{% if player.playerID %}
var playerObj = {
    id: {{ player.playerID }},
    nation: {{ player.nation }},
	reports: {{ player.reports }},
	tutStage: {{ player.tutorialStage }},
	timeK: {{ player.timeK }},
	timeP: {{ player.timeP }},
	timeSP: {{ player.SponsorAccount }},
    AddGold: function(gold) {
        var current = parseInt($('.bank').show().find('span').html()) || 0;
		if( current == 0 ){
			var gold_info="{{ constant('sztuk_zlota_txt') }}";
		}else{
			var gold_info='';
		}
        $('.bank').show().find('span').html(current+parseInt(gold)+" "+gold_info);
    },
	RemoveGold: function(gold) {
        var current = parseInt($('.bank').show().find('span').html()) || 0;
        $('.bank').show().find('span').html(current-parseInt(gold));
    },
	AddSoftCurrency: function(softCurrency) {
        var current = parseInt($('#kasa').show().find('span').html()) || 0;
        $('#kasa').show().find('span').html(current+parseInt(softCurrency));
    },
	
	RemoveSoftCurrency: function(softCurrency) {
        var current = parseInt($('#kasa').show().find('span').html()) || 0;
        $('#kasa').show().find('span').html(current-parseInt(softCurrency));
    },
	ActMaterials: function(materials) {
        var currentMaterials = parseInt($('#rawMaterials').html()) || 0;
        $('#rawMaterials').html(currentMaterials-parseInt(materials));
    }
}


{% endif %}

function showWindow(title, content, width, height, zindex)
{
    var popWindow = $('#game_popwindow');
    popWindow.find('h1.popwindow_title').show().html(title);
    popWindow.find('div.popwindow_content').html(content);
    popWindow.show().css('width', width).css('height', height).css('max-height', '640px').css('margin','0 auto ').css('margin-top', ((parseInt($('#game_popwindow').css('height'))/2) * -1) + 'px').css('z-index', zindex ).animate({'left': '0px'}, 500);
    $('#popwindow_overlay').css('z-index', zindex-1).show();
}
function hideWindow(now)
{
    if (now)
    {
        $('#game_popwindow').hide().html('<h1 class="popwindow_title"></h1><div title="{{ constant('panel_gry3') }}"  class="close"></div><div class="popwindow_content"></div>');
        $('#popwindow_overlay').hide();
    }
    else
    {
        $('#game_popwindow').delay(1000).fadeOut(500);
        $('#popwindow_overlay').delay(1300).fadeOut(500);
    }
}
function showActiveWindow(title, content, width, height, zindex)
{
    var window = $('#activeWindow');
    window.find('h1.windowTitle').show().html(title);
    window.find('div.windowBody').html(content);

    window.show().css('width', width).css('height', height).css('max-height', '640px').css('margin','0 auto').css('margin-top', ((parseInt($('#activeWindow').css('height'))/2) * -1) + 'px').css('z-index', zindex ).animate({'left': '0px'}, 500);
    $('#popwindowWindow').css('z-index', zindex-1).show();
}
function hideActiveWindow(now)
{
    if (now)
    {
        $('#activeWindow').hide().html('<div title="{{ constant('panel_gry3') }}" class="close"></div><h1 class="windowTitle"></h1><div class="windowBody"></div>');
        $('#popwindowWindow').hide();
    }
    else
    {
        $('#activeWindow').delay(1000).fadeOut(500);
        $('#popwindowWindow').delay(1300).fadeOut(500);
    }
}

function loadTitle(){
	$("*[title]").each(function() {
        $(this).hover(function(e) {
            // pokaż tooltip pod elementem
            $(this).mousemove(function(e) {
                var dY = e.pageY + 4;
                var dX = e.pageX + 4;
				if( ( $('#infoTooltip').width()+ 30 + dX ) > $(window).width() ){
					if( dX > $(window).width() ){ 
						dX = e.pageX - ($('#infoTooltip').width()+25);
					}else{
						dX = e.pageX - ($('#infoTooltip').width()+20);
					}
				}
				
				if( ( $('#infoTooltip').height()+ 30 + dY ) > $(window).height() ){
					if( dY > $(window).height() ){ 
						dY = e.pageY - ($('#infoTooltip').height()+25);
					}else{
						dY = e.pageY - ($('#infoTooltip').height()+20);
					}
				}
				
				
				$("#infoTooltip").css({'top': dY, 'left': dX});
            });
            $("#infoTooltip").stop(true, true);
            $("#infoTooltip").html($(this).attr('title')).fadeIn(50);
            $(this).removeAttr('title');
        }, function() {
            $("#infoTooltip").stop(true, true);
            $("#infoTooltip").fadeOut(50);
            $(this).attr('title', $("#infoTooltip").html());
        });
    });
}




/*
 * settings = {'formName': 'name', 'postData' => {}}
 * postData - napidsuje dane z forma jeśli mają te same nazwy
 */
function jsonLoad(url, settings, blockClick, callback)
{
	var postData = {};
	if (settings.formName)
	{
		var dane = $("#" + settings.formName).serializeArray();
		for (var i in dane) {
			if (dane[i].name)
				postData[dane[i].name] = dane[i].value
		}
	}
	if (settings.postData)
	{
		postData = settings.postData;
	}

    if (pageObj.blockClick === false)
    {
        if (blockClick) pageObj.blockClick = true;
        $.ajax({
            type: "POST",
            dataType: "json",
            url: "{{ constant("SUBDIR") }}" + url,
            data: {'postData': postData},
            success: function(data) {
                if (data.printError)
                {
                    $.fn.jAlert({
                        'title': '{{ constant("ingame9") }}',
                        'message': data.printError,
                        'theme': 'error'
                    });
                    pageObj.blockClick = false;
                }
                else
                {
                    pageObj.blockClick = false;
                    callback(data);
                }
            }
        });
    }
}
function zegar() {
	teraz = new Date().getTime(); // aktualna data
	dzien = new Date({{ infoDate }}).getTime(); // 2003.06.28 - 12:01:00

	// wyliczanie roznicy
	sekund = Math.abs((teraz-dzien)/1000);
	minut = Math.floor(sekund/60);
	godzin = Math.floor(minut/60);
	dni = Math.floor(godzin/24);
	lat = Math.floor(dni/365);

	// wyliczanie calego okresu
	sekund = Math.floor(sekund-minut*60);
	minut = Math.floor(minut-godzin*60);
	godzin = Math.floor(godzin-dni*24);
	dni = Math.floor(dni-lat*365);

	var roznica=" "+godzin+
	((minut<10)?":0":":")+minut+
	((sekund<10)?":0":":")+sekund;
	$('#czas').html(roznica);
	setTimeout("zegar()",1000);
	if (teraz>=dzien) {
		location.reload(true);
	}
}
    tak=-1;
    function zaznacz() {
        tak *=-1;
        d=document.form1;
        for (i=0;i<d.elements.length;i++) {
            if (d.elements[i].type=="checkbox") {
                if (tak == 1)
                {
                    d.elements[i].checked = true;
                }
                else
                {
                    d.elements[i].checked=false;
                }
            }
        }
    }
	$(function() {
		$('#sb_world ul').animate({ scrollTop : $('#sb_world ul').height() * 20 }, 'slow');
	});
$(document).ready(function() {
    $('#simple-accordion').simpleAccordion({collapsed: true,expanded: null});
    $('#simple-accordion1').simpleAccordion({collapsed: true,expanded: null});
    $('#simple-accordion2').simpleAccordion({collapsed: true,expanded: null});
    $('#simple-accordion3').simpleAccordion({collapsed: true,expanded: null});
    $('#simple-accordion4').simpleAccordion({collapsed: true,expanded: null});
    $('#simple-accordion5').simpleAccordion({collapsed: true,expanded: null});
    $('#simple-accordion6').simpleAccordion({collapsed: true,expanded: null});
	$('#game_popwindow').on('click', '.close', function() {
        hideWindow(true);
		$('#tooltip_okienko').remove();
		$('#infoTooltip').css('display','none');
		// usuwamy uruchomone interwały w fabrykach
		$('.upCl').each(function(index) {
            clearInterval(counterBuild[$(this).attr('id')]);	
        });
    });
	$('#activeWindow').on('click', '.close', function() {
        hideActiveWindow(true);
		$('#infoTooltip').css('display','none');
    });
	
	
	// ładujemy zegarerk
	
	//loadTimer( 15,'50131_1',3);
				
	// koniec zegarka			
				
    $('#alert_window').delay(2000).hide('slow');
    $('body').on('click touchstart', '.bank', function() {
		showActiveWindow(
                '<div id="sms" class="bigger_menu">{{ constant("pl_sms") }}</div><div id="online" class="bigger_menu" style="margin-left: -20px">{{ constant("pl_online") }}</div><div id="przelew" class="bigger_menu" style="margin-left: 20px">{{ constant("pl_przel") }}</div><div id="psc" class="bigger_menu">{{ constant("pl_psc") }}</div><div id="darmowe" class="bigger_menu">{{ constant("pl_darmoweZloto") }}</div>', 
                '<div id="body_platnosci">\
				<div id="buy_txt">\
					{{ constant("pl_txt") }}\
				</div>	\
				<div class="buyn">\
					<div id="step1">{{ constant("step1_txt")|raw }}</div>\
					<div id="code_qr"></div>\
					<div id="code_txt"></div>\
					<div id="step2">{{ constant("step2_txt") }}</div>\
					<div id="code2_txt">{{ constant("platnosci_end_txt") }}</div>\
					<div id="kod_sms">\
						<form id="send_GoldCode">\
							<input type="text" id="kod_premium" name="kod_premium" minlength="6" maxlength="6" style="width:206px;height:24px;font-size:13px;" placeholder="{{ constant('wpisz_kod_txt') }}" /><br>\
							<div id="send_qr">\
								<strong id="send_code">{{ constant("send_qr_txt") }}</strong>\
							</div>\
						</form>\
					</div>\
				</div>\
            </div>', 
                '640px', 'auto',101);
    });
	
	$('body').on('click touchstart', '.factory', function() {
		var code  = $(this).attr('num');
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		// usuwamy uruchomone interwały w fabrykach
		$('.upCl').each(function(index) {
            clearInterval(counterBuild[$(this).attr('id')]);	
        });
		$.ajax({
			type     : "GET",
			dataType : "json",
			url      : "fabryki/"+code,
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
				that.data('inprogress', 0);
				if(data.error){
					$.fn.jAlert({
						'title': '{{ constant("ingame9") }}',
						'message': data.error,
						'theme': 'error'
					});
				}else{
					showWindow( data.titleTableFactory, data.TableFactory+' '+data.headFactory+''+data.tableDeff+''+data.bodyTable+''+data.tableEnd, '600px', '563px',101);
						if( data.unitsOnBuild ){
							var ts = Math.round(new Date().getTime() / 1000| 0);
							var timeToEndBuild = data.unitsOnBuild.TurnBuild - ts;
							loadTimer( timeToEndBuild, ''+data.unitsOnBuild.id+'', data.unitsOnBuild.id, 2 );
						}
					if( data.samouczek.tutorial == 2 && data.samouczek.playerID == playerObj.id )
					{
						showActiveWindow( '{{ constant("comp_map1") }} 3','{{ constant("samouczek9")|raw }}','650px', 'auto', 101 );
					}
					
					$('.tooltip').draggable({
					  helper: 'clone'
					});
					$('.dropzone').droppable({
						accept: ".tooltip",
						drop: function(event, ui) {
							var droppable = $(this);
							var draggable = ui.draggable;
							// Move draggable into droppable
							if( $(this).children().length == 0 ){
								var drag = $('.dropzone').has(ui.draggable).length ? draggable : draggable.clone().draggable({
									accept    : '.tooltip',
									helper: 'clone'
								});
								drag.appendTo(droppable);
								$(this).attr( "num", draggable.attr( "num" ));
							}else{
								$(this).html('');
								draggable.parent().removeAttr("num");
								var drag = $('.dropzone').has(ui.draggable).length ? draggable : draggable.clone().draggable({
									accept    : '.tooltip',
									helper: 'clone'
								});
								drag.appendTo(droppable);
								$(this).attr( "num", draggable.attr( "num" ));
								
							}
						}
					});
				}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	$('body').on('click touchstart', '.ustawienia', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "GET",
			dataType : "json",
			url      : "ustawienia/"+that.attr("num"),
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
			
			}
			else
			{
				showWindow( data.title, data.bodyTable, '600px', '580px',100);
				if(data.height){
					$("#tury_edit").css("height", data.height+"px");
				}
				if(data.sound == 1 ){
					$("#sound_money").html("<audio autoplay><source src=\"app/templates/assets/sounds/klik.ogg\" type=\"audio/ogg\"/><source src=\"app/templates/assets/sounds/klik.mp3\"/></audio>");
				}
				
				
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	$('body').on('click touchstart', '.kadra', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "GET",
			dataType : "json",
			url      : "kadra",
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
				if(data.kadra){
				
				}else{
					alert(data.error);
				}
			}
			else
			{
				showActiveWindow( data.titleKadra, data.tableDeff+''+data.bodyKadra+''+data.tableEnd, '640px', '506px',100);
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	$('body').on('click touchstart', '#nowaKadra', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "GET",
			dataType : "json",
			url      : "kadra",
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
				if(data.kadra){
				
				}else{
					alert(data.error);
				}
			}
			else
			{
				showActiveWindow( data.titleKadra, data.tableDeff+''+data.bodyKadra+''+data.tableEnd, '640px', '506px',100);
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	
	
    $('body').on('click touchstart', '.administrationNaw', function() {
        var code  = $(this).attr('num');
        var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
            type     : "GET",
            dataType : "json",
            url      : "administracja/"+code,
			beforeSend: function() {
				that.data('inprogress', 1);
			},
        }).done(function( data ) {
            that.data('inprogress', 0);
			if (data.error)
            {
                $.fn.jAlert({
                    'title': '{{ constant("ingame9") }}',
                    'message': data.error,
                    'theme': 'error'
                });
            }
            else
            {
                showActiveWindow( data.title, data.body, '1157px', '424px',101);
            }
        }).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
    });

    $('body').on('click touchstart', '#sendStartWorld',function(){
        jsonLoad('/uruchom-nowy-swiat', {'formName': 'formNewWorld'}, false, function(data) {
            alert( data.info );
        });
    });

	$('body').on('click touchstart', '#fabryki_kadra', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "GET",
			dataType : "json",
			url      : "kadra",
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
                $.fn.jAlert({
                    'title': '{{ constant("ingame9") }}',
                    'message': data.error,
                    'theme': 'error'
                });
				
			}
			else
			{
				showWindow( data.titleKadra, data.TableKadra+' '+data.headKadra+''+data.tableDeff+''+data.bodyKadra+''+data.tableEnd, '1157px', '600px',100);
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});

    $('body').on('click touchstart', '.fabryki_lista', function() {
        var code  = $(this).attr('num');
        var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
            type     : "GET",
            dataType : "json",
            url      : "loadTacticalData/"+code,
			beforeSend: function() {
				that.data('inprogress', 1);
			},
        }).done(function( data ) {
			that.data('inprogress', 0);           
		   if (data.printEerror)
            {
                $.fn.jAlert({
                    'title': '{{ constant("ingame9") }}',
                    'message': data.printError,
                    'theme': 'error'
                });

            }
            else
            {
                showWindow( data.titleTD, data.TableTD+' '+data.headTD+' '+data.TableTDm+' '+data.tableDeff+''+data.bodyTD+''+data.tableEnd, '600px', '600px',101);
            }
        }).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
    });



	$('body').on('click touchstart', '#muza', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "GET",
			dataType : "json",
			url      : "dzwieki",
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			$('#muza_txt').html(data.muza_txt);
			$('#muza').html(data.txt);
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$('body').on('click touchstart', '#zarowa', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "GET",
			dataType : "json",
			url      : "kogut",
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			$('#zarowa_txt').html(data.zarowa_txt);
			$('#zarowa').html(data.txt);
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$('body').on('click touchstart', '#stuffNaw', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "GET",
			dataType : "json",
			url      : "sztaby",
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
                $.fn.jAlert({
                    'title': '{{ constant("ingame9") }}',
                    'message': data.error,
                    'theme': 'error'
                });
			}
			else
			{
				showActiveWindow( data.blockTitle, data.txt, '1157px', 'auto',101);
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$('body').on('click touchstart', '#noweSztaby', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "GET",
			dataType : "json",
			url      : "sztaby",
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
                $.fn.jAlert({
                    'title': '{{ constant("ingame9") }}',
                    'message': data.error,
                    'theme': 'error'
                });
			}
			else
			{
				showActiveWindow( data.blockTitle, data.txt, '1157px', 'auto',101);
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	$('body').on('click touchstart', '.forum', function() {
		var page  = $(this).attr('num');
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "forum",
			data     : {'page': page},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
                $.fn.jAlert({
                    'title': '{{ constant("ingame9") }}',
                    'message': data.error,
                    'theme': 'error'
                });
			}
			else
			{
				showWindow( data.txt, data.body, '1157px', '466px',101);
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	$('body').on('click touchstart', '#nowySklep', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "GET",
			dataType : "json",
			url      : "sklep",
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
                $.fn.jAlert({
                    'title': '{{ constant("ingame9") }}',
                    'message': data.error,
                    'theme': 'error'
                });
			}
			else
			{
				showWindow( data.txt, data.body, '600px', data.width+'px', 101 );
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	
	
	$('body').on('click touchstart', '.buduj', function() {
		var nrUnit  = $(this).attr('num');
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "GET",
			dataType : "json",
			url      : "buduj/"+nrUnit,
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
            that.data('inprogress', 0);
			if (data.printError)
            {
                $.fn.jAlert({
                    'title': '{{ constant("ingame9") }}',
                    'message': data.printError,
                    'theme': 'error'
                });
                pageObj.blockClick = false;
            }
			else
			{
				$("#"+nrUnit).html(data.newDiv);
				playerObj.RemoveSoftCurrency(data.softCurrency);
                
				if( data.unitsOnBuild ){
					var ts = Math.round(new Date().getTime() / 1000| 0);
					var timeToEndBuild = data.unitsOnBuild.TurnBuild - ts;
					loadTimer( timeToEndBuild, ''+data.unitsOnBuild.id+'', data.unitsOnBuild.id, 2 );
				}
				
				if( data.tutorial && data.tutorial.playerID == playerObj.id )
                {
                    showActiveWindow( '{{ constant("comp_map1") }} 4', data.tutorial.tutorial, '650px', 'auto',101);
                }
				$('#infoTooltip').css('display','none');
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$('body').on('click touchstart', '.przyspiesz', function() {
		var nrUnit  = $(this).attr('num');
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "GET",
			dataType : "json",
			url      : "budujGoldUnit/"+nrUnit,
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
                $.fn.jAlert({
                    'title': '{{ constant("ingame9") }}',
                    'message': data.error,
                    'theme': 'error'
                });
			}
			else
			{
				showActiveWindow( '', data.info, '500px', 'auto',101);
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$('body').on('click touchstart', '#przyspiesz', function() {
		var nrUnit  = $(this).attr('num');
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "GET",
			dataType : "json",
			url      : "przyspiesz-budowe/"+nrUnit,
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
                $.fn.jAlert({
                    'title': '{{ constant("ingame9") }}',
                    'message': data.error,
                    'theme': 'error'
                });
			}
			else
			{
				playerObj.RemoveGold(data.gold);
				alert(data.info);
				hideActiveWindow(true);
				hideWindow(true);
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$('body').on('click touchstart', '#budujSponsor', function() {
		var name  = $(this).attr('name');
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "buduj-unit",
			data     : {'name': name},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
                $.fn.jAlert({
                    'title': '{{ constant("ingame9") }}',
                    'message': data.error,
                    'theme': 'error'
                });
			}
			else
			{
				alert(data.goto);
				hideActiveWindow(true);
				hideWindow(true);
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	
	
	$('body').on('click touchstart', '#anuluj', function() {
		var nrUnit  = $(this).attr('num');
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "GET",
			dataType : "json",
			url      : "anuluj/"+nrUnit,
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
                $.fn.jAlert({
                    'title': '{{ constant("ingame9") }}',
                    'message': data.error,
                    'theme': 'error'
                });
			}
			else
			{
				alert(data.alert);
				$("#"+nrUnit).html(data.loadDiv);
				playerObj.AddSoftCurrency(data.softCurrency);
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$('body').on('click touchstart', '.sztaby_name', function() {
		var jel = $(this).attr('name');
		var value = $("."+jel).val();
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "edytuj",
			data     : {'dane1': 1, 'dane2': jel,'dane3':value},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data_odp ) {
			that.data('inprogress', 0);
			if (data_odp.error)
			{
                $.fn.jAlert({
                    'title': '{{ constant("ingame9") }}',
                    'message': data_odp.error,
                    'theme': 'error'
                });
			}
			else
			{
				alert(data_odp.alert);
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$('body').on('click touchstart', '.sztaby_adm_add', function() {
			id_sztabu = $(this).attr('id');
			dane      = $(this).attr('var');
			var that = $(this);
			if ((that.data('inprogress') || 0) == 1) { return false;}
			$.ajax({
				type     : "POST",
				dataType : "json",
				url      : "edytuj",
				data     : {'dane1': 2, 'dane2': id_sztabu,'dane3':dane},
				beforeSend: function() {
					that.data('inprogress', 1);
				},
			}).done(function( data ) {
				that.data('inprogress', 0);
				if (data.error)
				{
                    $.fn.jAlert({
                        'title': '{{ constant("ingame9") }}',
                        'message': data.error,
                        'theme': 'error'
                    });
				}
				else
				{
					alert(data.alert);
					hideActiveWindow();
				}
			}).fail(function(jqXHR, textStatus, errorThrown) {
				that.data('inprogress', 0);
				alert(textStatus);
			});
		});
		$('body').on('click touchstart', '.sztaby_adm', function() {
			dane      = $(this).attr('var');
			var that = $(this);
			if ((that.data('inprogress') || 0) == 1) { return false;}
			$.ajax({
				type     : "POST",
				dataType : "json",
				url      : "edytuj",
				data     : {'dane1': 3, 'dane2': 0,'dane3':dane},
				beforeSend: function() {
					that.data('inprogress', 1);
				},
			}).done(function( data ) {
				that.data('inprogress', 0);
				if (data.error)
				{
                    $.fn.jAlert({
                        'title': '{{ constant("ingame9") }}',
                        'message': data.error,
                        'theme': 'error'
                    });
				}
				else
				{
					alert(data.alert);
					hideActiveWindow();
				}
			}).fail(function(jqXHR, textStatus, errorThrown) {
				that.data('inprogress', 0);
				alert(textStatus);
			});
		});
		$('#promocja_button').on("click",function(){
			var that = $(this);
			if ((that.data('inprogress') || 0) == 1) { return false;}
			$.ajax({
				type     : "POST",
				dataType : "json",
				url      : "promocja",
				beforeSend: function() {
					that.data('inprogress', 1);
				},
			}).done(function( data ) {
				that.data('inprogress', 0);
				if (data.error)
				{
                    $.fn.jAlert({
                        'title': '{{ constant("ingame9") }}',
                        'message': data.error,
                        'theme': 'error'
                    });
				}
				else
				{
					showActiveWindow( data.title, data.bodyLosowanie, '500px', 'auto',101);
					//hideWindow(true); gtre
				}
			}).fail(function(jqXHR, textStatus, errorThrown) {
				that.data('inprogress', 0);
				alert(textStatus);
			});
		});
		$('body').on('click touchstart', '#przycisk_promocji', function() {
			var that = $(this);
			if ((that.data('inprogress') || 0) == 1) { return false;}
			$.ajax({
				type     : "POST",
				dataType : "json",
				url      : "laduj-promocje",
				data     : {'stage':0},
				beforeSend: function() {
					that.data('inprogress', 1);
				},
			}).done(function( data ) {
				that.data('inprogress', 0);
				if (data.error)
				{
                    $.fn.jAlert({
                        'title': '{{ constant("ingame9") }}',
                        'message': data.error,
                        'theme': 'error'
                    });
				}
				else
				{
					showActiveWindow( data.title, data.tabela, '500px', '500px',101);
					//hideWindow(true);
				}
			}).fail(function(jqXHR, textStatus, errorThrown) {
				that.data('inprogress', 0);
				alert(textStatus);
			});
		});
		$('body').on('click touchstart', '#biore_za_gold', function() {
			var that = $(this);
			if ((that.data('inprogress') || 0) == 1) { return false;}
			$.ajax({
				type     : "POST",
				dataType : "json",
				url      : "laduj-promocje",
				data     : {'stage':0},
				beforeSend: function() {
					that.data('inprogress', 1);
				},
			}).done(function( data ) {
				that.data('inprogress', 0);
				if (data.error)
				{
                    $.fn.jAlert({
                        'title': '{{ constant("ingame9") }}',
                        'message': data.error,
                        'theme': 'error'
                    });
				}
				else
				{
					showActiveWindow( data.title, data.body, '360px', '130px',101);
					playerObj.RemoveGold(data.gold);
					$('#promocja_button').remove();
					//hideWindow(true);
				}
			}).fail(function(jqXHR, textStatus, errorThrown) {
				that.data('inprogress', 0);
				alert(textStatus);
			});
		});
		$('body').on('click touchstart', '#nextDraw', function() {
			var that = $(this);
			if ((that.data('inprogress') || 0) == 1) { return false;}
			$.ajax({
				type     : "POST",
				dataType : "json",
				url      : "laduj-promocje",
				data     : {'stage':1},
				beforeSend: function() {
					that.data('inprogress', 1);
				},
			}).done(function( data ) {
				that.data('inprogress', 0);
				if (data.error)
				{
                    $.fn.jAlert({
                        'title': '{{ constant("ingame9") }}',
                        'message': data.error,
                        'theme': 'error'
                    });
				}
				else
				{
					showActiveWindow( data.title2, data.tabela2+'<div id="biore_za_gold">{{ constant("losowanie3") }} '+data.cenaGold2+' {{ constant("losowanie4") }}</div><div id="nextDraw">{{ constant("losowanie5") }}</div>', '500px', '441px',101);
					playerObj.RemoveGold(5);
				}
			}).fail(function(jqXHR, textStatus, errorThrown) {
				that.data('inprogress', 0);
				alert(textStatus);
			});
		});
		$('body').on('click touchstart', '#kasa', function() {
			var that = $(this);
			if ((that.data('inprogress') || 0) == 1) { return false;}
			$.ajax({
				type     : "POST",
				dataType : "json",
				url      : "wymien-zloto",
				data     : {'stage':1, 'arrData':0},
				beforeSend: function() {
					that.data('inprogress', 1);
				},
			}).done(function( data ) {
				that.data('inprogress', 0);
				if (data.error)
				{
                    $.fn.jAlert({
                        'title': '{{ constant("ingame9") }}',
                        'message': data.error,
                        'theme': 'error'
                    });
				}
				else
				{
					showActiveWindow( data.title, data.body, '500px', '202px',101);
				}
			}).fail(function(jqXHR, textStatus, errorThrown) {
				that.data('inprogress', 0);
				alert(textStatus);
			});
		});
		$('body').on('click touchstart', '#replace_button', function() {
			 var wymiana=$("#defaultSlider").val();
			var that = $(this);
			if ((that.data('inprogress') || 0) == 1) { return false;}
			$.ajax({
				type     : "POST",
				dataType : "json",
				url      : "wymien-zloto",
				data     : {'stage':2, 'arrData': wymiana},
				beforeSend: function() {
					that.data('inprogress', 1);
				},
			}).done(function( data ) {
				that.data('inprogress', 0);
				if (data.error)
				{
                    $.fn.jAlert({
                        'title': '{{ constant("ingame9") }}',
                        'message': data.error,
                        'theme': 'error'
                    });
				}
				else
				{
					showActiveWindow( data.title, data.body, '500px', '500px',101);
					playerObj.AddSoftCurrency(data.PremiumCurrency);
					playerObj.RemoveGold(data.gold);
					if(data.gold0==1){
						 $('#gold_info').html(data.gold_info);
						 $('#gold_info1').css('display','none');
						 $('#gold_change_panel').remove();
						 $('.bank').html(data.bank);
					}
					hideActiveWindow();
				}
			}).fail(function(jqXHR, textStatus, errorThrown) {
				that.data('inprogress', 0);
				alert(textStatus);
			});
		});
		$('body').on('click touchstart', '.editPersonnel', function() {
			var idInzyniera = $(this).attr('name');
			var divIdent = $(this);
			var that = $(this);
			if ((that.data('inprogress') || 0) == 1) { return false;}
			$.ajax({
				type     : "POST",
				dataType : "json",
				url      : "editEngeener",
				data     : {'data': idInzyniera},
				beforeSend: function() {
					that.data('inprogress', 1);
				},
			}).done(function( data ) {
				that.data('inprogress', 0);
				if (data.error)
				{
                    $.fn.jAlert({
                        'title': '{{ constant("ingame9") }}',
                        'message': data.error,
                        'theme': 'error'
                    });
				}
				else

				{
					alert(data.alert);
					if(data.edit){
						playerObj.RemoveSoftCurrency(data.softCurrency);
					}else{
						playerObj.AddSoftCurrency(data.softCurrency);
					}
					divIdent.html(data.buttonText);
				}
			}).fail(function(jqXHR, textStatus, errorThrown) {
				that.data('inprogress', 0);
				alert(textStatus);
			});
		});
		$('body').on('click touchstart', '.sponsor', function() {
			var that = $(this);
			if ((that.data('inprogress') || 0) == 1) { return false;}
			$.ajax({
				type     : "POST",
				dataType : "json",
				url      : "sponsor",
				data     : {'stage':1, 'arrData':0},
				beforeSend: function() {
					that.data('inprogress', 1);
				},
			}).done(function( data ) {
				that.data('inprogress', 0);
				if (data.error)
				{
                    $.fn.jAlert({
                        'title': '{{ constant("ingame9") }}',
                        'message': data.error,
                        'theme': 'error'
                    });
				}
				else
				{
					showActiveWindow( data.titleSponsor, data.sponsor_txt+' '+ data.sponsorForm, '600px', '600px',101);
					//hideWindow(true);
				}
			}).fail(function(jqXHR, textStatus, errorThrown) {
				that.data('inprogress', 0);
				alert(textStatus);
			});
		});
		$('body').on('click touchstart', '#sponsor_continue', function() {
			var wartosc = $("input[name='sponsor']:checked").val();
			var that = $(this);
			if ((that.data('inprogress') || 0) == 1) { return false;}
			$.ajax({
				type     : "POST",
				dataType : "json",
				url      : "sponsor",
				data     : {'stage':2, 'arrData':wartosc},
				beforeSend: function() {
					that.data('inprogress', 1);
				},
			}).done(function( data ) {
				that.data('inprogress', 0);
				if (data.error)
				{
                    $.fn.jAlert({
                        'title': '{{ constant("ingame9") }}',
                        'message': data.error,
                        'theme': 'error'
                    });
				}
				else
				{
					hideActiveWindow();
					alert(data.sponsorTxt);
					playerObj.RemoveGold(data.gold);
					$('.sponsor').html(data.info);
					$('.sponsor').attr( "title", data.info1 );
				}
			}).fail(function(jqXHR, textStatus, errorThrown) {
				that.data('inprogress', 0);
				alert(textStatus);
			});
		});
		$('body').on('click touchstart', '#moreSponsorButton', function() {
			$("#moreSponsorTxt").slideToggle("slow");
		});
		$('body').on('click touchstart', '.temat', function() {
            $(this).find('.newPost').remove();
                if( $('.newPost').size() == 0 )
                {
                    $('#koperta').css('display','none');
                }
			var that = $(this);
			if ((that.data('inprogress') || 0) == 1) { return false;}
			$.ajax({
				type     : "POST",
				dataType : "json",
				url      : "forumTemat",
				data     : {'topic':$(this).attr('numer'), 'page':$(this).attr('num')},
				beforeSend: function() {
					that.data('inprogress', 1);
				},
			}).done(function( data ) {
				that.data('inprogress', 0);
				if (data.error)
				{
                    $.fn.jAlert({
                        'title': '{{ constant("ingame9") }}',
                        'message': data.error,
                        'theme': 'error'
                    });
				}
				else
				{
					showActiveWindow( data.Topic, data.bodyTopic, '1100px', 'auto',101);

					//hideWindow(true);
				}
			}).fail(function(jqXHR, textStatus, errorThrown) {
				that.data('inprogress', 0);
				alert(textStatus);
			});
		});
		
		$('body').on('click touchstart', '.section', function() {
			var that = $(this);
			if ((that.data('inprogress') || 0) == 1) { return false;}
			$.ajax({
				type     : "POST",
				dataType : "json",
				url      : "forumSectionTopic",
				data     : {'section':$(this).attr('numer'), 'page':$(this).attr('num')},
				beforeSend: function() {
					that.data('inprogress', 1);
				},
			}).done(function( data ) {
				that.data('inprogress', 0);
				if (data.error)
				{
                    $.fn.jAlert({
                        'title': '{{ constant("ingame9") }}',
                        'message': data.error,
                        'theme': 'error'
                    });
				}
				else
				{
					showWindow( data.txt, data.body, '1157px', '600px',101);

					//hideWindow(true);
				}
			}).fail(function(jqXHR, textStatus, errorThrown) {
				that.data('inprogress', 0);
				alert(textStatus);
			});
		});
		
		
		$('body').on('click touchstart', '#dodaj_post', function() {
			showActiveWindow(  'Dodaj temat', '<form><input type="hidden" id="sectionID" value="'+$(this).attr('num')+'"/><input type="text" id="temat_add"  placeholder="{{ constant('ingame10') }}"/><br><textarea id="wiadomosc_add" placeholder="{{ constant('add_forum_tresc_alert') }}"></textarea><div id="div_count"> {{ constant('mess_gracz6') }} <label id="count">2000</label> {{ constant('ingame11') }}</div><br><input type="button" id="submit_add_temat" value="{{ constant('ingame12') }}"/></form>', '600px', '315px',101);
			$("#wiadomosc_add").keyup(function(){
				var max = 2000;
				var box=$(this).val();
				var count= max-box.length-1;
					if(box.length <= max){
						$('#count').html(count);
					}else{
						alert('{{ constant("ingame13") }}!');
						$(this).val($(this).val().substring(0,max - 1));
					}
				return false;
			});
		});
		$('body').on('click touchstart', '#submit_add_temat', function() {
			var tresc = $('#wiadomosc_add').val();
			var temat = $('#temat_add').val();
			var sectionID = $('#sectionID').val();
			if(tresc.length==0){
				alert('{{ constant("comp_map19") }}!');
			}else if(temat.length==0){
				alert('{{ constant("ingame14") }}!');
			}else{
				var that = $(this);
				if ((that.data('inprogress') || 0) == 1) { return false;}
				$.ajax({
					type     : "POST",
					dataType : "json",
					url      : "tematEdit",
					data     : {'topic':temat, 'content':tresc,'action':1,'num':0,'sectionID':sectionID},
					beforeSend: function() {
						that.data('inprogress', 1);
					},
				}).done(function( data ) {
					that.data('inprogress', 0);
					if (data.error)
					{
                        $.fn.jAlert({
                            'title': '{{ constant("ingame9") }}',
                            'message': data.error,
                            'theme': 'error'
                        });
					}
					else
					{
						alert(data.info);
						hideWindow(true);
						hideActiveWindow(true);
					}
				}).fail(function(jqXHR, textStatus, errorThrown) {
					that.data('inprogress', 0);
					alert(textStatus);
				});
			}
		});
	$('body').on('click touchstart', '.edit_temat', function() {
		var dane = $(this).attr('num');
		//var main = 2000-tresc.length;
		var that = $(this);
			if ((that.data('inprogress') || 0) == 1) { return false;}
			$.ajax({
				type     : "POST",
				dataType : "json",
				url      : "tematEdit",
				data     : {'topic':0, 'content':0,'action':7,'num':dane,'sectionID':0},
				beforeSend: function() {
					that.data('inprogress', 1);
				},
			}).done(function( data ) {
				that.data('inprogress', 0);
				if (data.error)
				{
                    $.fn.jAlert({
                        'title': '{{ constant("ingame9") }}',
                        'message': data.error,
                        'theme': 'error'
                    });
				}
				else
				{
					console.log("data tresc="+data.tresc+", tytul="+data.tytul);
					showWindow( '{{ constant("ingame15") }}', '<form><input type="text" id="temat_edit1"  value="'+data.tytul+'"/><br><textarea id="wiadomosc_edit" num="'+dane+'">'+data.tresc+'</textarea><div id="div_count"> {{ constant("mess_gracz6") }} <label id="count">0</label> {{ constant("ingame11") }}</div><br><input type="button" id="submit_edit_temat" value="{{ constant('ingame16') }}"/></form>', '600px', '342px',102);
					$('#wiadomosc_edit').html(data.tresc);
					$("#wiadomosc_edit").keyup(function(){
						var max = 2000;
						var box=$(this).val();
						var count= max-box.length-1;
							if(box.length <= max){
								$('#count').html(count);
							}else{
								alert('{{ constant("ingame13") }}');
								$(this).val($(this).val().substring(0,max - 1));
							}
						return false;
					});

				}
			}).fail(function(jqXHR, textStatus, errorThrown) {
				that.data('inprogress', 0);
				alert(textStatus);
			});
		
		//showWindow( '{{ constant("ingame15") }}', '<form><input type="text" id="temat_edit1"  value="'+$("h1.windowTitle").html()+'"/><br><textarea id="wiadomosc_edit" num="'+dane+'">'+tresc+'</textarea><div id="div_count"> {{ constant("mess_gracz6") }} <label id="count">'+main+'</label> {{ constant("ingame11") }}</div><br><input type="button" id="submit_edit_temat" value="{{ constant('ingame16') }}"/></form>', '600px', '342px',102);
	});
	$('body').on('click touchstart', '#submit_edit_temat', function() {
		var num  = $("#wiadomosc_edit").attr('num');
		var tresc1 = $('#wiadomosc_edit').val();
		var temat1 = $('#temat_edit1').val();
		if(tresc1.length==0){
			alert('{{ constant("comp_map19") }}!');
		}else if(temat1.length==0){
			alert('{{ constant("ingame14") }}!');
		}else{
			var that = $(this);
			if ((that.data('inprogress') || 0) == 1) { return false;}
			$.ajax({
				type     : "POST",
				dataType : "json",
				url      : "tematEdit",
				data     : {'topic':temat1, 'content':tresc1,'action':2,'num':num,'sectionID':0},
				beforeSend: function() {
					that.data('inprogress', 1);
				},
			}).done(function( data ) {
				that.data('inprogress', 0);
				if (data.error)
				{
                    $.fn.jAlert({
                        'title': '{{ constant("ingame9") }}',
                        'message': data.error,
                        'theme': 'error'
                    });
				}
				else
				{
					alert(data.info);
					hideWindow(true);
					$('#'+num).html(data.nTopic);
				}
			}).fail(function(jqXHR, textStatus, errorThrown) {
				that.data('inprogress', 0);
				alert(textStatus);
			});
		}
	});	
	$('body').on('click touchstart', '#dodaj_kom', function() {
		var dane = $(this).attr('num');
		var main = 2000;
		showWindow( '{{ constant("dodaj_komentarz_txt") }}','<form><textarea id="wiadomosc_edit" num="'+dane+'"></textarea><div id="div_count"> {{ constant("mess_gracz6") }} <label id="count">'+main+'</label> {{ constant("ingame11") }}</div><br><input type="button" id="submit_dodaj_kom" value="{{ constant('dodaj_komentarz_txt') }}"/></form>', '600px', '282px',102);
		$("#wiadomosc_edit").keyup(function(){
			var max = 2000;
			var box=$(this).val();
			var count= max-box.length-1;
				if(box.length <= max){
					$('#count').html(count);
				}else{
					alert('{{ constant("ingame13") }}');
					$(this).val($(this).val().substring(0,max - 1));
				}
			return false;
		});
	});	
	$('body').on('click touchstart', '#submit_dodaj_kom', function() {
		var num  = $("#wiadomosc_edit").attr('num');
		var tresc2 = $('#wiadomosc_edit').val();
		if(tresc2.length==0){
			alert("wpisz treść komentarza!");
		}else{
			var that = $(this);
			if ((that.data('inprogress') || 0) == 1) { return false;}
			$.ajax({
				type     : "POST",
				dataType : "json",
				url      : "tematEdit",
				data     : {'topic':0, 'content':tresc2,'action':3,'num':num,'sectionID':0},
				beforeSend: function() {
					that.data('inprogress', 1);
				},
			}).done(function( data ) {
				that.data('inprogress', 0);
				if (data.error)
				{
                    $.fn.jAlert({
                        'title': '{{ constant("ingame9") }}',
                        'message': data.error,
                        'theme': 'error'
                    });
				}
				else
				{
					alert(data.info);
					hideActiveWindow(true);
                    hideWindow(true);

				}
			}).fail(function(jqXHR, textStatus, errorThrown) {
				that.data('inprogress', 0);
				alert(textStatus);
			});
		}
	});		
	$('body').on('click touchstart', '.edit_', function() {
		var dane = $(this).attr('num');
		var main = 2000;
		$('.popwindow_content').css('height', '241px');
		var that = $(this);
			if ((that.data('inprogress') || 0) == 1) { return false;}
			$.ajax({
				type     : "POST",
				dataType : "json",
				url      : "komentarzEdit",
				data     : {'num':dane},
				beforeSend: function() {
					that.data('inprogress', 1);
				},
			}).done(function( data ) {
				that.data('inprogress', 0);
				if (data.error)
				{
                    $.fn.jAlert({
                        'title': '{{ constant("ingame9") }}',
                        'message': data.error,
                        'theme': 'error'
                    });
				}
				else
				{
					showWindow( '{{ constant("ingame17") }}','<form><textarea id="wiadomosc_edit" num="'+data.num+'"></textarea><div id="div_count"> {{ constant("mess_gracz6") }} <label id="count">'+main+'</label> {{ constant("ingame11") }}</div><br><input type="button" id="submit_edit_forum" value="{{ constant('ingame18') }}"/></form>', '600px', '342px',102);
					$('#wiadomosc_edit').html(data.tresc);
					$("#wiadomosc_edit").keyup(function(){
						var max = 2000;
						var box=$(this).val();
						var count= max-box.length-1;
							if(box.length <= max){
								$('#count').html(count);
							}else{
								alert('{{ constant("ingame13") }}');
								$(this).val($(this).val().substring(0,max - 1));
							}
						return false;
					});

				}
			}).fail(function(jqXHR, textStatus, errorThrown) {
				that.data('inprogress', 0);
				alert(textStatus);
			});
		
		
		
		
		
		
	});		
	$('body').on('click touchstart', '#submit_edit_forum', function() {
		var num  = $("#wiadomosc_edit").attr('num');
		var tresc3 = $('#wiadomosc_edit').val();
		if(tresc3.length==0){
			alert("wpisz treść komentarza!");
		}else{
			var that = $(this);
			if ((that.data('inprogress') || 0) == 1) { return false;}
			$.ajax({
				type     : "POST",
				dataType : "json",
				url      : "tematEdit",
				data     : {'topic':0, 'content':tresc3,'action':4,'num':num,'sectionID':0},
				beforeSend: function() {
					that.data('inprogress', 1);
				},
			}).done(function( data ) {
				that.data('inprogress', 0);
				if (data.error)
				{
                    $.fn.jAlert({
                        'title': '{{ constant("ingame9") }}',
                        'message': data.error,
                        'theme': 'error'
                    });
				}
				else
				{
					alert(data.info);
					hideWindow(true);
				}
			}).fail(function(jqXHR, textStatus, errorThrown) {
				that.data('inprogress', 0);
				alert(textStatus);
			});
		}
	});
	$('body').on('click touchstart', '.blockAutor', function() {
		var num  = $(this).attr('num');
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}	
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "adminOperation",
			data     : {'action':1,'num':num},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
				$.fn.jAlert({
					'title': '{{ constant("ingame9") }}',
					'message': data.error,
					'theme': 'error'
				});
			}
			else
			{
				alert(data.info);
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$('body').on('click touchstart', '.deleteCom', function() {
		var num  = $(this).attr('num');
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "adminOperation",
			data     : {'action':6,'num':num},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
				$.fn.jAlert({
					'title': '{{ constant("ingame9") }}',
					'message': data.error,
					'theme': 'error'
				});
			}
			else
			{
				alert(data.info);
				hideWindow(true);
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$('body').on('click touchstart', '.delete_', function() {
		var num  = $(this).attr('num');
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "adminOperation",
			data     : {'action':7,'num':num},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
				$.fn.jAlert({
					'title': '{{ constant("ingame9") }}',
					'message': data.error,
					'theme': 'error'
				});
			}
			else
			{
				alert(data.info);
				hideWindow(true);
				hideActiveWindow(true);
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$('body').on('click touchstart', '.zakup_sklep', function() {
		var num  = $(this).attr('num');
		var code  = $(this).attr('code');
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.confirm({
			title: '{{ constant("ingame19") }}!',
			content: '{{ constant("ingame20") }}?',
			confirmButton: '{{ constant("ingame21") }}',
			cancelButton: '{{ constant("ingame22") }}',
			confirm: function () {
				$.ajax({
					type     : "POST",
					dataType : "json",
					url      : "kupuje-za-zloto",
					data     : {'code':code,'num':num},
					beforeSend: function() {
						that.data('inprogress', 1);
					},
				}).done(function( data ) {
					that.data('inprogress', 0);
					if (data.error)
					{
						$.fn.jAlert({
							'title': '{{ constant("ingame9") }}',
							'message': data.error,
							'theme': 'error'
						});
					}
					else
					{
						alert(data.info);
						hideActiveWindow(true);
						$("#un_"+data.getOffUnit).remove();
						if(data.goldBuy==1){
							playerObj.RemoveGold(data.gold);
						}else if(data.creditBuy==1){
							playerObj.RemoveSoftCurrency(data.softCurrency);
						}
					}
				}).fail(function(jqXHR, textStatus, errorThrown) {
					that.data('inprogress', 0);
					alert(textStatus);
				});
			}
		});
	});	
	
	
	$('body').on('click touchstart', '.battleRaport', function() {
		var num  = $(this).attr('rapid');
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "pokaz-raport",
			data     : {'num':num},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
                $.fn.jAlert({
                    'title': '{{ constant("ingame9") }}',
                    'message': data.error,
                    'theme': 'error'
                });
			}
			else
			{
				if(data.seen == 0 )
				{
					if( $("#rapAll").html() > 1 )
					{
						$('#rapAll').html( $("#rapAll").html() - 1 );
					}
					else
					{
						$('#rapAll').remove();
					}
				}
				showActiveWindow(data.temat,data.bitwaT, 540, 610,101);
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	$('body').on('click touchstart', '.rapDel', function() {
		var num  = $(this).attr('num');
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "usun-raport",
			data     : {'num':num},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
                $.fn.jAlert({
                    'title': '{{ constant("ingame9") }}',
                    'message': data.error,
                    'theme': 'error'
                });
			}
			else
			{
				alert("raport o id="+num+" usunieto");
				hideWindow(true);
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	
	
	
	
	
	
	
	
	$('#samouczek_button').on("click",function(){
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "samouczek",
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
                $.fn.jAlert({
                    'title': '{{ constant("ingame9") }}',
                    'message': data.error,
                    'theme': 'error'
                });
			}
			else
			{
				showActiveWindow( data.title, data.bodySamouczek+', tut='+data.tutStage, '650px',data.heightWindow,101);
				//hideWindow(true );
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	$('#nowySamouczek').on("click",function(){
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "samouczek",
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
                $.fn.jAlert({
                    'title': '{{ constant("ingame9") }}',
                    'message': data.error,
                    'theme': 'error'
                });
			}
			else
			{
				showActiveWindow( data.title, data.bodySamouczek, '650px',data.heightWindow,101);
				if( data.goldNagroda > 0 ){
					// pokazujemy okienko z nagrodą
					$('#upGold').css('display', 'block');
					$('#upGold').html(data.goldNagrodaTXT);
				}
				playerObj.tutStage = data.tutStage;
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	$('body').on('click touchstart', '#tray', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "GET",
			dataType : "json",
			url      : "tray",
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
				that.data('inprogress', 0);
				if(data.error){
					$.fn.jAlert({
						'title': '{{ constant("ingame9") }}',
						'message': data.error,
						'theme': 'error'
					});
				}else{
					showWindow( data.title, data.body, '600px', data.height+'px', 101);
				}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	$('body').on('click touchstart', '.usePrizeAcc', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "usePrizeAcc",
			data     : {'id':$(this).attr('num') },
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
				that.data('inprogress', 0);
				if(data.error){
					$.fn.jAlert({
						'title': '{{ constant("ingame9") }}',
						'message': data.error,
						'theme': 'error'
					});
				}else{
					var ts = Math.round(new Date().getTime() / 1000| 0);
					newTimeTT = data.newTime - ts;
					loadTimer( newTimeTT, 'timerSP', playerObj.id, 6 );
					showWindow( data.title, data.body, '600px', data.height+'px', 101);
				}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	$('body').on('click touchstart', '.upCl', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "usePrize",
			data     : {'uid':$(this).attr('id'), 'step':1, 'step2':1, 'num':0},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
				that.data('inprogress', 0);
				if(data.error){
					$.fn.jAlert({
						'title': '{{ constant("ingame9") }}',
						'message': data.error,
						'theme': 'error'
					});
				}else{
					var ts = Math.round(new Date().getTime() / 1000| 0);
					//newTimeTT = data.newTime - ts;
					//loadTimer( newTimeTT, 'timerSP', playerObj.id, 6 );
					showWindow( data.title, data.body, '600px', data.height+'px', 101);
				}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	
	$('body').on('click touchstart', '.usePrize', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "usePrize",
			data     : {'uid':$(this).attr('uid'), 'step':2,'step2':$(this).attr('step2'), 'num':$(this).attr('num') },
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
				that.data('inprogress', 0);
				if(data.error){
					$.fn.jAlert({
						'title': '{{ constant("ingame9") }}',
						'message': data.error,
						'theme': 'error'
					});
				}else{
					var ts = Math.round(new Date().getTime() / 1000| 0);
					//newTimeTT = data.newTime - ts;
					//loadTimer( newTimeTT, 'timerSP', playerObj.id, 6 );
					showWindow( data.title, data.body, '600px', data.height+'px', 101);
				}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	
	
	
	
    $('body').on('click touchstart', '#dalej', function() {
        var num  = $(this).attr('name');
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		if(num == 1){
			hideWindow(true);
			hideActiveWindow(true);
		}else{
			$.ajax({
				type     : "POST",
				dataType : "json",
				url      : "samouczek",
				beforeSend: function() {
					hat.data('inprogress', 1);
				},
			}).done(function( data ) {
				that.data('inprogress', 0);
				if (data.error)
				{
					$.fn.jAlert({
						'title': '{{ constant("ingame9") }}',
						'message': data.error,
						'theme': 'error'
					});
				}
				else {
					if (data.bodySamouczek != false)
					{
						showActiveWindow(data.title, data.bodySamouczek, '650px', data.heightWindow,101);
					}
					else
					{
						hideWindow(true);
					}
					//
				}
			}).fail(function(jqXHR, textStatus, errorThrown) {
				that.data('inprogress', 0);
				alert(textStatus);
			});
		}
    });
	
	
	
	
	
	$('#faqForm').on("click",function(){
		var frazy = $('#frazy').val();
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "poradnik",
			data     : {'frazy':frazy},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
                $.fn.jAlert({
                    'title': '{{ constant("ingame9") }}',
                    'message': data.error,
                    'theme': 'error'
                });
			}
			else
			{
				showActiveWindow( data.title, data.body, '1157px','600px',101);
				//hideWindow(true);
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$('#wt').on("click",function(){
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "topBox",
			data     : {'data':1},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
                $.fn.jAlert({
                    'title': '{{ constant("ingame9") }}',
                    'message': data.error,
                    'theme': 'error'
                });
			}
			else
			{
				showActiveWindow( data.title, data.body, '800px','600px',101);
				//hideWindow(true);
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$('#gt').on("click",function(){
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "topBox",
			data     : {'data':2},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
                $.fn.jAlert({
                    'title': '{{ constant("ingame9") }}',
                    'message': data.error,
                    'theme': 'error'
                });
			}
			else
			{
				showActiveWindow( data.title, data.body, '800px','600px',101);
				//hideWindow(true);
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$('body').on('click touchstart', '.messageBox', function() {
		var nickName  = $(this).attr('nickName');
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "message",
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
                $.fn.jAlert({
                    'title': '{{ constant("ingame9") }}',
                    'message': data.error,
                    'theme': 'error'
                });
			}
			else
			{
				
				showWindow( data.title, '<div id="messageWindow"><div id="playerMessageList">'+data.authorList+'</div><div id="navMessage"></div><div id="messageBody"></div><div id="formMessage"></div></div>', '800px','521px',101);
				//hideWindow(true);..
				if( nickName )
				{
					$("#messageBody").html('<form><input type="text" id="addresseUser" readonly value="'+nickName+'"><br><textarea rows="5" placeholder="{{ constant('comp_map19') }}" required="required" id="descriptionMessage" /><br><input type="button" id="sendMessage" value="{{ constant('panel_gry19') }}"/></form><br>');
				}
				
			
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$('body').on('click touchstart', '#messAll', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "message",
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
                $.fn.jAlert({
                    'title': '{{ constant("ingame9") }}',
                    'message': data.error,
                    'theme': 'error'
                });
			}
			else
			{
				showWindow( data.title, '<div id="messageWindow"><div id="playerMessageList">'+data.authorList+'</div><div id="navMessage"></div><div id="messageBody"></div><div id="formMessage"></div></div>', '800px','600px',100);
				//hideWindow(true);
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$('body').on('click touchstart', '.writeMessage', function() {
		var num = $(this).attr('num');
		if( num == 0 ){
			$("#messageBody").html('<form><input type="text" id="addresseUser" placeholder="{{ constant('ingame23') }}" required="required"><br><textarea rows="5" placeholder="{{ constant('comp_account78') }}" required="required" id="descriptionMessage" /><br><input type="button" id="sendMessage" value="{{ constant('panel_gry19') }}"/></form><br>');
		}else{
			/*
			$.ajax({
				type     : "POST",
				dataType : "json",
				url      : "trustEdit",
				data     : {'num':num },
			}).done(function( data ) {
				if (data.error)
				{
					alert(data.error);
				}
				else
				{
					$("#"+num+"").html(data.text);
				}
			});
			*/
		}
	});
	
	$('body').on('click touchstart', '#sendMessage', function() {
		var one = $('#descriptionMessage').val();
		var two = $('#addresseUser').val();
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "sendMess",
			data     : {'descriptionMessage':one,'addresseUser':two },
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
				$.fn.jAlert({
					'title': '{{ constant("ingame9") }}',
					'message': data.error,
					'theme': 'error'
				});
			}
			else
			{
				$("#navMessage").html(data.nav);
				$("#messageBody").html(data.messageHistory);
				$("#playerMessageList").html(data.authorList);
				$("#formMessage").html('<form><textarea rows="5" placeholder="{{ constant('ingame23') }}" required="required" id="descriptionMessage" /><input type="hidden" id="dialogID" value="'+data.num+'"/><br><input type="button" id="sendMessageDialog" value="{{ constant('panel_gry19') }}"/></form>');
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$('body').on('click touchstart', '.authorDialog', function() {
		var num = $(this).attr('num');
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "messEdit",
			data     : {'descriptionMessage':0,'num':num,'step':1 },
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
				$.fn.jAlert({
					'title': '{{ constant("ingame9") }}',
					'message': data.error,
					'theme': 'error'
				});
			}
			else
			{
				//alert(data.authorList);
				
				$("#navMessage").html(data.nav);
				$("#messageBody").html(data.messageHistory);
				$("#playerMessageList").html(data.authorList);
				if(data.mess == 0 ){
					$('#messAll').css('display','none');
				}else{
					$('#messAll').html(data.mess);
				}
				$("#formMessage").html('<form><textarea rows="5" placeholder="{{ constant('comp_account78') }}" required="required" id="descriptionMessage" /><input type="hidden" id="dialogID" value="'+num+'"/><br><input type="button" id="sendMessageDialog" value="{{ constant('panel_gry19') }}"/></form>');
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$('body').on('click touchstart', '.authorAlert', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "messEdit",
			data     : {'descriptionMessage':0,'num':0,'step':5 },
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
				$.fn.jAlert({
					'title': '{{ constant("ingame9") }}',
					'message': data.error,
					'theme': 'error'
				});
			}
			else
			{
				$("#navMessage").html(data.nav);
				$("#messageBody").html(data.messageHistory);
				$("#playerMessageList").html(data.authorList);
				$("#formMessage").html('');
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$('body').on('click touchstart', '#sendMessageDialog', function() {
		var one = $('#descriptionMessage').val();
		var two = $('#dialogID').val();
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "messEdit",
			data     : {'descriptionMessage':one,'num':two,'step':2 },
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
				$.fn.jAlert({
					'title': '{{ constant("ingame9") }}',
					'message': data.error,
					'theme': 'error'
				});
			}
			else
			{
				$("#navMessage").html(data.editMessage);
				$("#messageBody").html(data.messageHistory);
				$("#playerMessageList").html(data.authorList);
				$("#formMessage").html('<form><textarea rows="5" placeholder="{{ constant('comp_account78') }}" required="required" id="descriptionMessage" /><input type="hidden" id="dialogID" value="'+two+'"/><br><input type="button" id="sendMessageDialog" value="{{ constant('panel_gry19') }}"/></form>');
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$('body').on('click touchstart', '#application', function() {
		var num = $(this).attr('num');
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "messEdit",
			data     : {'descriptionMessage':0,'num':num,'step':4 },
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {  
				that.data('inprogress', 0);
				alert(data.error);
				hideActiveWindow(true);
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	$('body').on('click touchstart', '.trusted', function() {
		var num = $(this).attr('id');
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "trustEdit",
			data     : {'num':num },
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
                $.fn.jAlert({
                    'title': '{{ constant("ingame9") }}',
                    'message': data.error,
                    'theme': 'error'
                });
			}
			else
			{
                if( data.samouczek.aktiv == 1 && data.samouczek.playerID == playerObj.id )
                {
                    showActiveWindow( 'tytul', data.samouczek.tresc, '650px','auto',101);
                }
                else
                {
                    $("#"+num+"").html(data.text);
                }

			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	$('body').on('click touchstart', '.profil_button', function() {
		var num  = $(this).attr('num');
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "GET",
			dataType : "json",
			url      : "profil/"+num,
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
                $.fn.jAlert({
                    'title': '{{ constant("ingame9") }}',
                    'message': data.error,
                    'theme': 'error'
                });
			}
			else
			{
				showActiveWindow( data.title, data.playerBody, '620px','602px',101);
				//hideWindow(true);
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});

	$('body').on('click touchstart', '#add_motto', function() {
		var tresc = $('#motto_add').val();
		if(tresc.length==0){
			alert("{{constant('ingame24') }}!");
		}else{
			var that = $(this);
			if ((that.data('inprogress') || 0) == 1) { return false;}
			$.ajax({
				type     : "POST",
				dataType : "json",
				url      : "editProfil",
				data     : {'stage':1,'data':tresc},
				beforeSend: function() {
					that.data('inprogress', 1);
				},
			}).done(function( data ) {
				that.data('inprogress', 0);
				if (data.error)
				{
                    $.fn.jAlert({
                        'title': '{{ constant("ingame9") }}',
                        'message': data.error,
                        'theme': 'error'
                    });
				}
				else
				{
					alert(data.body);
					$('#motto_profil').html(tresc);
					hideWindow(true);
				}
			}).fail(function(jqXHR, textStatus, errorThrown) {
				that.data('inprogress', 0);
				alert(textStatus);
			});
		}
	});

    $('body').on('submit', '#uploadimage', (function(e) {
        e.preventDefault();
		$.ajax({
            url: "zaladuj-zdjecie", // Url to which the request is send
            type: "POST",             // Type of request to be send, called as method
            dataType : "json",
            data: new FormData(this), // Data sent to server, a set of key/value pairs (i.e. form fields and values)
            contentType: false,       // The content type used when sending data to the server.
            cache: false,             // To unable request pages to be cached
            processData:false,        // To send DOMDocument or non processed data file it is set to false
            success: function(data)   // A function to be called if request succeeds
            {
                $("#avatar_gracza").html('<img src="'+data.fota+'"/><div id="usun_fota">{{ constant("mess_usun") }}</div>');
            }
        });
    }));
    $('body').on('click touchstart', '#usun_fota', function() {
        var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
            type     : "POST",
            dataType : "json",
            url      : "usun-zdjecie",
			beforeSend: function() {
				that.data('inprogress', 1);
			},
        }).done(function( data ) {
            that.data('inprogress', 0);
			if (data.error)
            {
                $.fn.jAlert({
                    'title': '{{ constant("ingame9") }}',
                    'message': data.error,
                    'theme': 'error'
                });
            }
            else
            {
                $('#avatar_gracza').html(data.info);
            }
        }).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
    });
	$('body').on('click touchstart', '#edit_motto', function() {
		showWindow( "{{ constant('ingame27') }}", "<form><textarea id=\"motto_add\" placeholder=\"{{ constant('ingame26') }}\">{{ player.descriptionProfil|raw }}</textarea><br><input type=\"button\" id=\"add_motto\" value=\"{{ constant('ingame25') }}\"/>" , '550px','auto',102);
		//hideWindow(true);
	});
	$('body').on('click touchstart', '#finanse', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "editCash",
			data     : {'stage':1},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
				$.fn.jAlert({
					'title': '{{ constant("ingame9") }}',
					'message': data.error,
					'theme': 'error'
				});
				
				if( data.goldNagroda > 0 ){
					// pokazujemy okienko z nagrodą
					$('#upGold').css('display', 'block');
					$('#upGold').html(data.goldNagrodaTxt);
				
				}
			}
			else
			{
				showActiveWindow( data.title, data.body, '620px','auto',101);
				
				var ts = Math.round(new Date().getTime() / 1000| 0);
				if( playerObj.timeK  > ts ){		
					var newTime = playerObj.timeK - ts;
					loadTimer( newTime, 'timerK', playerObj.id, 3 );
				}
				
				
				
				
				
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$('body').on('click touchstart', '.sztaby', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "editStuff",
			data     : {'id':$(this).attr('id'),'var':$(this).attr('var')},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
				$.fn.jAlert({
					'title': '{{ constant("ingame9") }}',
					'message': data.error,
					'theme': 'error'
				});
			}
			else
			{
				showActiveWindow( data.title, data.info, '400px','auto',101);
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$('body').on('click touchstart', '#akcja', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "editCash",
			data     : {'stage':2},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
				hideActiveWindow(true);
				if(data.minusSoft>0){
					playerObj.RemoveSoftCurrency(data.minusSoft);
				}
				if(data.plusSoft>0){
					playerObj.AddSoftCurrency(data.plusSoft);
				}
				$('#finanse').remove();
				// sprawdzamy, czy gracz wygrał złoto
				if(data.plusGold > 0 ){
					// gold do doebrania, pokazujemy okienko
					$('#upGold').css('display', 'block');
					$('#upGold').html(data.goldNagrodaTxt);
					$('#upGold').css('z-index','99999');
				}
					if(data.onTimer == 1){
						$('#licznikKasa').append('<div id="timerK" title="{{ constant('ingame5') }}"></div>');
						var ts = Math.round(new Date().getTime() / 1000| 0);
						playerObj.timeK = data.timeK;
						var newTime = playerObj.timeK - ts;
						loadTimer( newTime, 'timerK', playerObj.id, 3 );
					}
					
					
				showActiveWindow( data.title, data.body, data.width, data.height,101);
				
				
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
    $('body').on('click touchstart', '#send', function() {
        var dane_wiadomosci = $("input[name='wiadomosc[]']:checked").serialize();
		//alert(dane_wiadomosci);
        if(dane_wiadomosci!=''){
            var that = $(this);
			if ((that.data('inprogress') || 0) == 1) { return false;}
			$.ajax({
                type     : "POST",
                dataType : "json",
                url      : "usun-wiadomosci",
                data     : {'data':dane_wiadomosci },
				beforeSend: function() {
					that.data('inprogress', 1);
				},
            }).done(function( data ) {
                that.data('inprogress', 0);
				if (data.error)
                {
                    $.fn.jAlert({
                        'title': '{{ constant("ingame9") }}',
                        'message': data.error,
                        'theme': 'error'
                    });
                }
                else
                {
					$("#playerMessageList").html(data.authorList);
					if(data.rap == 0 ){
						$("#rapAll").css('display', 'none');
					}else{
						$("#rapAll").html(data.rap);
					}
					
					if(data.mess == 0 ){
						$("#messAll").css('display', 'none');
					}else{
						$("#messAll").html(data.mess);
					}
					$("#messageBody").html('');
					$("#application").remove();
					
                }
            }).fail(function(jqXHR, textStatus, errorThrown) {
				that.data('inprogress', 0);
				alert(textStatus);
			});
        }else{
            alert("{{ constant('ingame28') }}");
        }
    });

	    $("#submit").on("click", function() {
        var _0xc752 = ["\x66\x61\x64\x65\x49\x6E", "\x53\x70\x72\x61\x77\x64\x7A\x61\x6D\x2E\x2E\x2E\x2E", "\x74\x65\x78\x74", "\x6D\x65\x73\x73\x61\x67\x65\x62\x6F\x78", "\x61\x64\x64\x43\x6C\x61\x73\x73", "\x72\x65\x6D\x6F\x76\x65\x43\x6C\x61\x73\x73", "\x23\x6D\x73\x67\x62\x6F\x78", "\x61\x6A\x61\x78\x5F\x6C\x6F\x67\x69\x6E\x2E\x70\x68\x70", "\x76\x61\x6C", "\x23\x75\x73\x65\x72\x6E\x61\x6D\x65", "\x23\x70\x61\x73\x73\x77\x6F\x72\x64", "\x23\x6C\x61\x6E\x67", "\x72\x61\x6E\x64\x6F\x6D", "\x79\x65\x73", "\x6C\x6F\x63\x61\x74\x69\x6F\x6E", "\x70\x61\x6E\x65\x6C\x2E\x70\x68\x70", "\x66\x61\x64\x65\x54\x6F", "\x6D\x65\x73\x73\x61\x67\x65\x62\x6F\x78\x6F\x6B", "\x6C\x6F\x67\x75\x6A\u0119\x2E\x2E\x2E", "\x68\x74\x6D\x6C", "\x72\x65\x73\x65\x74", "\x6D\x65\x73\x73\x61\x67\x65\x62\x6F\x78\x65\x72\x72\x6F\x72", "\x4E\x61\x20\x74\x79\x6D\x20\u015B\x77\x69\x63\x69\x65\x20\x74\x72\x77\x61\x20\x52\x45\x53\x45\x54\x20\x67\x72\x79\x2E\x20\x5A\x61\x70\x72\x61\x73\x7A\x61\x6D\x79\x20\x64\x7A\x69\x73\x69\x61\x6A\x20\x6F\x20\x67\x6F\x64\x7A\x2E\x20\x31\x32\x2E", "\x50\x6F\x64\x61\u0142\x65\u015B\x20\x62\u0142\u0119\x64\x6E\x65\x20\x64\x61\x6E\x65", "\x70\x6F\x73\x74"];
        $(_0xc752[6])[_0xc752[5]]()[_0xc752[4]](_0xc752[3])[_0xc752[2]](_0xc752[1])[_0xc752[0]](1000);
        $[_0xc752[24]](_0xc752[7], {user_name: $(_0xc752[9])[_0xc752[8]](), password: $(_0xc752[10])[_0xc752[8]](), lang: $(_0xc752[11])[_0xc752[8]](), rand: Math[_0xc752[12]]()}, function(_0xe77dx1) {
            if (_0xe77dx1 == _0xc752[13]) {
                $(_0xc752[6])[_0xc752[16]](200, 0.1, function() {
                    $(this)[_0xc752[19]](_0xc752[18])[_0xc752[4]](_0xc752[17])[_0xc752[16]](900, 1, function() {
                        document[_0xc752[14]] = _0xc752[15];
                    });
                });
            } else {
                if (_0xe77dx1 == _0xc752[20]) {
                    $(_0xc752[6])[_0xc752[16]](200, 0.1, function() {
                        $(this)[_0xc752[19]](_0xc752[22])[_0xc752[4]](_0xc752[21])[_0xc752[16]](900, 1);
                    });
                } else {
                    $(_0xc752[6])[_0xc752[16]](200, 0.1, function() {
                        $(this)[_0xc752[19]](_0xc752[23])[_0xc752[4]](_0xc752[21])[_0xc752[16]](900, 1);
                    });
                }
                ;
            }
            ;
        });
        return false;
    });
    $("#password").blur(function() {
        $("#login_form").trigger('submit');
    });
    $('#screeny').on("click", function() {
        $('#overlay_screen').fadeIn('fast', function() {
            $('#boxpopup_screen').css('display', 'block');
            $('#boxpopup_screen').animate({'left': '25%'}, 500);
        });
    });
    $('#film').on("click", function() {
        $('#overlay_film').fadeIn('fast', function() {
            $('#boxpopup_film').css('display', 'block');
            $('#boxpopup_film').animate({'left': '25%'}, 500);
        });
    });

    $('body').on('click touchstart', '.close', function() {
        $('#boxpopup_rej').css('display', 'none');
        $('#overlay_rej').fadeOut('slow', function() {
        });
        $('#boxpopup_rev').css('display', 'none');
        $('#overlay_rev').fadeOut('slow', function() {
        });
        $('#boxpopup_log').css('display', 'none');
        $('#overlay_log').fadeOut('slow', function() {
        });
        $('#boxpopup_screen').css('display', 'none');
        $('#overlay_screen').fadeOut('slow', function() {
        });
        $('#boxpopup_film').css('display', 'none');
        $('#overlay_film').fadeOut('slow', function() {
        });
    });
	function ustawCookie(nazwa, wartosc, sekund) {
		if (sekund) {
			var data = new Date();
			data.setTime(data.getTime()+(sekund*1000));           
			var expires = "; expires="+data.toGMTString();
		} else {
			var expires = "";
		}
		document.cookie = nazwa+"=" + wartosc + expires + "; path=/";
	}
	function pokazCookie(nazwa) {
		if (document.cookie!="") { //jeżeli document.cookie w ogóle istnieje
			var cookies=document.cookie.split("; ");  //tworzymy z niego tablicę ciastek
			for (i=0; i<cookies.length; i++) { //i robimy po niej pętlę
				var nazwaCookie=cookies[i].split("=")[0]; //nazwa ciastka
				var wartoscCookie=cookies[i].split("=")[1]; //wartość ciastka
				if (nazwaCookie===nazwa) {
					return unescape(wartoscCookie) //jeżeli znalezliśmy ciastko o danej nazwie, wtedy zwracamy jego wartość
				}
			}
		}
	}
	function usunCookie(nazwa) {               
		document.cookie = nazwa + '=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path=/';
	}
	
	
	$("#przyciskRadio").on("click",function(){
		$("#przyciskRadio").html("Ra");
		$("#radio").slideToggle("slow");
			if(pokazCookie('panel3')=='none'){
				usunCookie('panel3');
			}else{
				ustawCookie('panel3', 'none' , 1000);
                $(function() {
                    $('#sb_world ul').animate({ scrollTop : $('#sb_world ul').height() * 20 }, 'slow');
                });
			}
	});
	
	if(typeof pokazCookie('panel3') == "undefined"){
		$("#radio").css("display","none");
	}else{
		$("#radio").css("display","block");
	}
	//zegar();
	$('#ustawienia_button').on("click",function(){
		$('#ustawienia').fadeIn('fast', function() {
			$('#boxpopup_ustawienia').css('display','block');
			$('#boxpopup_ustawienia').css('position','absolute');
			$('#boxpopup_ustawienia').animate({'left':'25%'},500);
			$("#sound_money").html("<audio autoplay><source src=\"app/templates/assets/sounds/klik.ogg\" type=\"audio/ogg\"/><source src=\"app/templates/assets/sounds/klik.mp3\"/></audio>");
		});
	});
	$('#faq_button').on("click",function(){
		$('#faq').fadeIn('fast', function() {
			$('#boxpopup_faq').css('display','block');
			$('#boxpopup_faq').css('position','absolute');
			$('#boxpopup_faq').animate({'left':'8%'},500);
			$("#sound_money").html("<audio autoplay><source src=\"app/templates/assets/sounds/klik.ogg\" type=\"audio/ogg\"/><source src=\"app/templates/assets/sounds/klik.mp3\"/></audio>");
		});
	});
	
	$('#zamknij_faq').on("click",function(){
		$('#faq').css('display','none');
		$('#boxpopup_faq').css('display','none');
	});
	$('body').on('click touchstart', '#submit_pass',function(){
		jsonLoad('/zapisz_ustawienia', {'formName': 'password_edit'}, false, function(data) {
			alert(data.info);
			document.getElementById('old_form_pass').value='';
			document.getElementById('form_pass').value='';
			document.getElementById('form_pass1').value='';
		});
	});
	$('body').on('click touchstart', '.zapisz_raporty',function(){
		jsonLoad('/zapisz_ustawienia', {'formName': 'reports_edit'}, false, function(data) {
			playerObj.reports = data.option;
			alert('Raporty ustawione');
		});
	});
	$('body').on('click touchstart', '#zapisz_tury',function(){
		jsonLoad('/zapisz_ustawienia', {'formName': 'formularz_schemat'}, false, function(data) {
			alert('Tury ustawione');
			$("#tury_edit").css("height", "100px");
			$("#turki_edit").html("<div id=\"tury_no_active\">{{ constant('comp_account96') }}:)</div>");
		});
	});
	$('body').on('click touchstart', '.zapisz_urlop',function(){
		jsonLoad('/zapisz_ustawienia', {'formName': 'editUrlop'}, false, function(data) {
			alert('Urlop ustawiony.');
			$("#urlop_edit").html( "{{ constant('ustawienia29') }} "+data.option );
		});
	});
	$('body').on('click touchstart', '#zapisz_miasto',function(){
		jsonLoad('/zapisz_ustawienia', {'formName': 'editCityName'}, false, function(data) {
			alert('Nazwa miasta zmieniona.');
		});
	});
	
	$('#rep_all').on("click",function(){
		showWindow( 'Naprawa jednostek', '{{ constant("rep_txt") }} <div id="rep_all_ok">{{ constant("rep_all_ok_txt") }}</div>', '440px', '150px',100);
	});
	$('body').on('click touchstart', '#rep_all_ok',function(){
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "napraw-jednostki",
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
				alert(data.error);
			}
			else
			{
				showWindow('{{ constant("ingame29") }}','{{ constant("ingame30") }}', '440px', '120px',100 );
				playerObj.RemoveGold(data.gold);
				$( "#rep_all" ).remove();
				hideWindow();
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	$("#activeWindow").on("click", "#sms",function(){
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "getPaymentCode",
			data     : {'pID':1},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.printError)
			{
				$.fn.jAlert({
					'title': '{{ constant("ingame37") }}',
					'message': data.printError,
					'theme': 'error'
				});
			}else{
				$("#buy_txt").html(data.rev);
				$('.bigger_menu').each(function(index, value) {
				   if ($(this).attr('id') == 'sms') $(this).css('color',' #f6c770');
				   else $(this).css('color',' #b7a27b');
				});
				$('.buyn').css('display','none');
				$('#buy_txt').css('display','block');
				$("#activeWindow").css('margin-top', ((parseInt($('#activeWindow').css('height'))/2) * -1) + 'px');
				$("#sound_money").html("<audio autoplay><source src=\"app/templates/assets/sounds/klik.ogg\" type=\"audio/ogg\"/><source src=\"zasoby/muz/klik.mp3\"/></audio>");
				
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	
	$("#activeWindow").on("click", "#online",function(){
	    var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "getPaymentCode",
			data     : {'pID':2},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.printError)
			{
				$.fn.jAlert({
					'title': '{{ constant("ingame37") }}',
					'message': data.printError,
					'theme': 'error'
				});
			}else{
				$("#buy_txt").html(data.rev);
				$('.bigger_menu').each(function(index, value) {
				   if ($(this).attr('id') == 'online') $(this).css('color',' #f6c770');
				   else $(this).css('color',' #b7a27b');
				});
				$('.buyn').css('display','none');
				$('#buy_txt').css('display','block');
				$("#activeWindow").css('margin-top', ((parseInt($('#activeWindow').css('height'))/2) * -1) + 'px');
				$("#sound_money").html("<audio autoplay><source src=\"app/templates/assets/sounds/klik.ogg\" type=\"audio/ogg\"/><source src=\"zasoby/muz/klik.mp3\"/></audio>");
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	$("#activeWindow").on("click", "#darmowe",function(){
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "getPaymentCode",
			data     : {'pID':3},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.printError)
			{
				$.fn.jAlert({
					'title': '{{ constant("ingame37") }}',
					'message': data.printError,
					'theme': 'error'
				});
			}else{
				$("#buy_txt").html(data.rev);
				$('.bigger_menu').each(function(index, value) {
				   if ($(this).attr('id') == 'darmowe') $(this).css('color',' #f6c770');
				   else $(this).css('color',' #b7a27b');
				});
				$('.buyn').css('display','none');
				$('#buy_txt').css('display','block');
				$("#activeWindow").css('margin-top', ((parseInt($('#activeWindow').css('height'))/2) * -1) + 'px');
				$("#sound_money").html("<audio autoplay><source src=\"app/templates/assets/sounds/klik.ogg\" type=\"audio/ogg\"/><source src=\"zasoby/muz/klik.mp3\"/></audio>");
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	$("#activeWindow").on("click", "#przelew",function(){
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "getPaymentCode",
			data     : {'pID':4},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.printError)
			{
				$.fn.jAlert({
					'title': '{{ constant("ingame37") }}',
					'message': data.printError,
					'theme': 'error'
				});
			}else{
				$("#buy_txt").html(data.rev);
				$('.bigger_menu').each(function(index, value) {
				   if ($(this).attr('id') == 'przelew') $(this).css('color',' #f6c770');
				   else $(this).css('color',' #b7a27b');
				});
				$('.buyn').css('display','none');
				$('#buy_txt').css('display','block');
				$("#activeWindow").css('margin-top', ((parseInt($('#activeWindow').css('height'))/2) * -1) + 'px');
				$("#sound_money").html("<audio autoplay><source src=\"app/templates/assets/sounds/klik.ogg\" type=\"audio/ogg\"/><source src=\"zasoby/muz/klik.mp3\"/></audio>");
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});	
	});
	$("#activeWindow").on("click", "#psc",function(){
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "getPaymentCode",
			data     : {'pID':5},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.printError)
			{
				$.fn.jAlert({
					'title': '{{ constant("ingame37") }}',
					'message': data.printError,
					'theme': 'error'
				});
			}else{
				$("#buy_txt").html(data.rev);
				$('.bigger_menu').each(function(index, value) {
				   if ($(this).attr('id') == 'psc') $(this).css('color',' #f6c770');
				   else $(this).css('color',' #b7a27b');
				});
				$('.buyn').css('display','none');
				$('#buy_txt').css('display','block');
				$("#activeWindow").css('margin-top', ((parseInt($('#activeWindow').css('height'))/2) * -1) + 'px');
				$("#sound_money").html("<audio autoplay><source src=\"app/templates/assets/sounds/klik.ogg\" type=\"audio/ogg\"/><source src=\"zasoby/muz/klik.mp3\"/></audio>");
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});		
	});
	$("#activeWindow").on("click","#button_sell_psc",function(){
		var wartosc = $("input[name='amount']:checked").val();
		window.location.replace("../index_psc.php?amount="+wartosc+" ");
	});
	$("#activeWindow").on("click", "#button_sell",function(){
		var wartosc = $("input[name='amount']:checked").val();
		$.ajax({
			type     : "GET",
			dataType : "json",
			url      : "../kupuje_gold.php",
			data     : "sell="+wartosc,
			
			async: false,
			success: function(odp){
				$("#body_platnosci").html("<div id=\"przycisk_online2\"><form action=\""+odp['target']+"\" method=\"POST\"><input type=\"hidden\" name=\"id\" value=\""+odp['id']+"\"/><input type=\"hidden\" name=\"service\" value=\""+odp['service']+"\"/>"+odp['amount']+"<input type=\"hidden\" name=\"lang\"  value=\""+odp['lang']+"\"/><input type=\"hidden\" name=\"userdata\" value=\""+odp['dane_gold']+"\"/><input type=\"hidden\" name=\"sign\" value=\""+odp['sign']+"\"/><input type=\"submit\" class=\"button_sell\" value=\""+odp['submit']+"\" /></form></div>");
				$("#body_platnosci").css("height","");
				$('html, body').animate({scrollTop:200}, 800);
			}
		});
	});
	$('body').on('click touchstart', '#buy1', function() {
		$('.buyn').css('display','block');
		$('#buy_txt').css('display','none');
		$("#code_txt").html("{{ constant("platnosci1_txt")|raw }}");
		$('#code_qr').css('background','url(https://img.cashbill.pl/qr/75480/ad.wichry) no-repeat');
	});
	$('body').on('click touchstart', '#buy2', function() {
		$('.buyn').css('display','block');
		$('#buy_txt').css('display','none');
		$("#code_txt").html("{{ constant("platnosci2_txt")|raw }}");
		$('#code_qr').css('background','url(https://img.cashbill.pl/qr/79480/ad.qichry) no-repeat');
	});
	$('body').on('click touchstart', '#buy3', function() {
		$('.buyn').css('display','block');
		$('#buy_txt').css('display','none');
		$("#code_txt").html("{{ constant("platnosci3_txt")|raw }}");
		$('#code_qr').css('background','url(https://img.cashbill.pl/qr/92022/ad.wichry) no-repeat');
	});
	$('body').on('click touchstart', '#buy4', function() {
		$('.buyn').css('display','block');
		$('#buy_txt').css('display','none');
		$("#code_txt").html("{{ constant("platnosci4_txt")|raw }}");
		$('#code_qr').css('background','url(https://img.cashbill.pl/qr/92550/ad.wichry) no-repeat');
	});
	$('body').on('click touchstart', '#send_code', function() {
		jsonLoad('/kup_zloto', {'formName': 'send_GoldCode'}, false, function(data) {
		$('#platnosci').css('display','none');
		$('#boxpopup_platnosci').css('display','none');
		$("#body_platnosci").html("{{ constant("pl_txt") }}");
		// I aktualizacja złota gracza
		playerObj.AddGold(data.gold);
		alert(data.komunikat);
		});
	});
	$('body').on('click touchstart', '#button_sell', function() {
		jsonLoad('/przygotujFormularz', {'formName': 'cashBillForm'}, false, function(data) {
			$('#boxpopup_platnosci').css('display','none');
			$('#buy_txt').css('display','block');
			$('.buyn').css('display','none');
			$("#buy_txt").html("<div id=\"przycisk_online2\"><form action=\""+data.target+"\" method=\"POST\"><input type=\"hidden\" name=\"service\" value=\""+data.service+"\"/>"+data.amount+"<input type=\"hidden\" name=\"lang\"  value=\""+data.lang+"\"/><input type=\"hidden\" name=\"userdata\" value=\""+data.dane_gold+"\"/><input type=\"hidden\" name=\"sign\" value=\""+data.sign+"\"/><input type=\"submit\" class=\"button_sell\" value=\""+data.submit+"\" /></form></div>");	
		});
	});



	
	
	$('#pogoda').on("mouseover",function(){
			$('#pogoda_opis').css('display','block');
	});
	$('#pogoda').on("mouseout",function(){
			$('#pogoda_opis').css('display','none');
	});
	$('#pagon').on("click",function(){
		$("#pagon_info").css("display","block");
	});
	$('#close_info').on("click",function(){
		$("#pagon_info").css("display","none");
	});
	
	$('body').on('click touchstart', '.submit_zmiana', function() {
		var worldID=$( "#soflow-color option:selected" ).val();
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "GET",
			dataType : "json",
			url      : "zaloguj-na-swiat/"+worldID,
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
				jAlert(data.error);


			}
			else
			{
				if (data.inworld === true) window.location.href = 'mapa';
				else 
				{
					showWindow('{{ constant("ingame36") }}', '<div style="display: inline; width: 100%;"><div style="width: 70px; text-align: center; float: left; margin: 50px 50px 50px 60px;"><a href="#" onclick="jsonLoad(&quot;/nowe-konto-na-swiecie/'+worldID+'/2&quot, true, function() { window.location.href=&quot;mapa&quot; }); return false;">Niemcy</a></div><div style="width: 70px; text-align: center; float: left; margin: 50px;"><a href="#" onclick="jsonLoad(&quot;/nowe-konto-na-swiecie/'+worldID+'/1&quot;, true, function() { window.location.href=&quot;mapa&quot; }); return false;">Polska</a></div></div>', '400px', '200px',100);
				}
			}
		 }).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	//obsługa jednostek Sponsora w bloku
	$("#listaJednostek").on("click",function(){
		$("#content").load("loadUnits/1_1");
		$("#sponsorUnitList").slideToggle();
	});
	
	$("#piechota").on("click",function(){
		$("#content").load("loadUnits/1_1");
		$("#unit_on").css("left", "371px");
	});
	$("#lotnictwo").on("click",function(){
		$("#content").load("loadUnits/4_1");
		$("#unit_on").css("left", "434px");
	});
	$("#pancerne").on("click",function(){
		$("#content").load("loadUnits/2_1");
		$("#unit_on").css("left", "497px");
	});
	$("#flota").on("click",function(){
		$("#content").load("loadUnits/5_1");
		$("#unit_on").css("left", "561px");
	});
	$("#przeciwlotnicze").on("click",function(){
		$("#content").load("loadUnits/3_1");
		$("#unit_on").css("left", "625px");
	});
	$("#artyleria").on("click",function(){
		$("#content").load("loadUnits/6_1");
		$("#unit_on").css("left", "686px");
	});
	$('body').on('click touchstart', '.next_page', function() {
		var  id = $(this).attr('id');
		$("#content").load("loadUnits/"+id+"");
	});
	$('body').on('click touchstart', '.rev_page', function() {
		var  id = $(this).attr('id');
		$("#content").load("loadUnits/"+id+"");
	});
	$("#unit_on").css("left", "371px");


    $('body').on('click touchstart', '#usuwanie_link', function() {
        var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
            type     : "GET",
            dataType : "json",
            url      : "usun-konto",
			beforeSend: function() {
				that.data('inprogress', 1);
			},
        }).done(function( data ) {
            that.data('inprogress', 0);
			if (data.printError)
            {
                $.fn.jAlert({
                    'title': '{{ constant("ingame37") }}',
                    'message': data.printError,
                    'theme': 'error'
                });
                setTimeout(function(){
                            window.location.href = 'wyloguj';
                },
                5000);
            }
        }).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
    });



	$('body').on('click touchstart', '#misje', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "GET",
			dataType : "json",
			url      : "loadMission",
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.printError)
			{
				$.fn.jAlert({
					'title': '{{ constant("ingame37") }}',
					'message': data.printError,
					'theme': 'error'
				});

			}else{
				showWindow('Misje',data.info, '440px', data.height+'px',100 );
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	
	$('body').on('click touchstart', '.crashMission', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "crashMission",
			data     : {'mission': $(this).attr('num') },
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.printError)
			{
				$.fn.jAlert({
					'title': '{{ constant("ingame37") }}',
					'message': data.printError,
					'theme': 'error'
				});

			}else{
				showWindow('Misje',data.info, '440px', '150px',100 );
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	
	$('.podGrupaBC').on("mouseover",function(){
			$('#podgrupaDatownik').css('display','block');
	});
	$('.podGrupaBC').on("mouseout",function(){
			$('#podgrupaDatownik').css('display','none');
	});

	$('body').on('click touchstart', '#noweWyloguj', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "GET",
			dataType : "json",
			url      : "loadLogoutWindow",
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.printError)
			{
				$.fn.jAlert({
					'title': '{{ constant("ingame37") }}',
					'message': data.printError,
					'theme': 'error'
				});
			}else{
				$('#panelWyloguj').html(data.loadWindow);
				$('#panelWyloguj').css('display','block');
				
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$('body').on('click touchstart', '#closeWyloguj', function() {
		$('#panelWyloguj').css('display','none');
	});
	
	$('body').on('click touchstart', '#closeOknoJednostki', function() {
		$('#tooltip_okienko').remove();
	});

	$('body').on('click touchstart', '.tooltip', function() {
		
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "getUnitData",
			data     : {'unitID':$(this).attr('num'),'loc':$(this).attr('loc')},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.printError)
			{
				$.fn.jAlert({
					'title': '{{ constant("ingame37") }}',
					'message': data.printError,
					'theme': 'error'
				});
			}else{
				var to = $('#tooltip_okienko');
				if(to.length) {
					$('#tooltip_okienko').html(data.bodyTable);
				}else{
					$('body').append('<div id="tooltip_okienko">'+data.bodyTable+'</div>');
				}
				
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	$('body').on(
	'mouseover', '#info_urlop_on', function() {
		$('#info_urlop').show();
	});
	$('body').on('mouseout', '#info_urlop_on', function() {
		$('#info_urlop').hide();
	});

	
	var touchtimeTAI = 0;
	$('body').on('click touchstart', '.tile_active', function() {
		if (touchtimeTAI == 0) {
        // set first click
        touchtimeTAI = new Date().getTime();
		} else {
        // compare first click to this click and see if they occurred within double click threshold
			if (((new Date().getTime()) - touchtimeTAI) < 500) {
            // double click occurred
				touchtimeTAI = 0;	
				//alert("double clicked");	
		
				var coords  = $(this).attr('coords');
				singleCoord = coords.split(',');
				var that = $(this);
				if ((that.data('inprogress') || 0) == 1) { return false;}
				$.ajax({
					type     : "POST",
					dataType : "json",
					url      : "prepareMission",
					data     : {'x':singleCoord[0],'y':singleCoord[1]},
					beforeSend: function() {
						that.data('inprogress', 1);
					},
				}).done(function( data ) {
					that.data('inprogress', 0);
					if (data.printError)
					{
						$.fn.jAlert({
							'title': '{{ constant("ingame37") }}',
							'message': data.printError,
							'theme': 'error'
						});
					}else{
						showWindow('Misje',data.info, '440px', '400px',100 );
					}
				}).fail(function(jqXHR, textStatus, errorThrown) {
					that.data('inprogress', 0);
					alert(textStatus);
				});
			} else {
				// not a double click so set as a new first click
				touchtimeTAI = new Date().getTime();
			}
		}		
	});

	$('body').on('click touchstart', '#btn_formMission', function() {
		var that = $(this);
		var mission =$( "#newCommand option:selected" ).val();
		var corpsID =$( "#corpusNewCommand option:selected" ).val();
		var coordx  = $('#newMission').attr('coordx');
		var coordy  = $('#newMission').attr('coordy');
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "saveMission",
			data     : {'mission':mission,'corpsID':corpsID,'x':coordx,'y':coordy},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
				$.fn.jAlert({
					'title': '{{ constant("ingame37") }}',
					'message': data.error,
					'theme': 'error'
				});
			}else{
				showWindow('Misje',data.info, '440px', '400px',100 );
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$('body').on('click touchstart', '.more', function() {
        $(this).siblings('.szczegoly_kampanii').slideToggle("slow");
        if ($(this).attr('class') == "more"){
        $(this).addClass("minus");
        var aaa = $("#notes_tekst").height();
        var new_aaa=aaa+200;
        $('#notes_tekst').css("height",""+new_aaa+"px");
        var bb = $("#profil_kampanie").height();
        var new_bb=bb+200;
        $('#profil_kampanie').css("height",""+new_bb+"px");
        }else{
        $(this).removeClass("minus");
        var aaa = $("#notes_tekst").height();
        var new_aaa=aaa-200;
        $('#notes_tekst').css("height",""+new_aaa+"px");
        var bb = $("#profil_kampanie").height();
        var new_bb=bb-200;
        $('#profil_kampanie').css("height",""+new_bb+"px");
        }
	});
	
	$('body').on('click touchstart', '#kampanie_przycisk', function() {
		$("#profil_kampanie").css('display','block');
		$("#profil_gracza").css('display','none');
	});
	$('body').on('click touchstart', '#kampanie_przycisk1', function() {
		$("#profil_kampanie").css('display','none');
		$("#profil_gracza").css('display','block');
	});
	
	$('body').on('click touchstart', '.endWorld', function() {
		var worldID  = $(this).attr('num');
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "endWorld",
			data     : {'worldID':worldID},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.printError)
			{
				$.fn.jAlert({
					'title': '{{ constant("ingame37") }}',
					'message': data.printError,
					'theme': 'error'
				});
			}else{
				showWindow('resety',data.info, '440px', '400px',100 );
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	$('body').on('click touchstart', '#getGold', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "getGold",
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
				$.fn.jAlert({
					'title': '{{ constant("ingame37") }}',
					'message': data.error,
					'theme': 'error'
				});
			}else{
				showWindow('{{ constant("ingame38") }}',data.info, '440px', '118px',100 );
				$("#upGold").css('display','none');
				if(data.plusGold>0){
					playerObj.AddGold(data.plusGold);
				}
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});

	
	$('body').on('click touchstart', '.multiban', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "multiBan",
			data     : {'nick':$(this).attr('nick')},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
				$.fn.jAlert({
					'title': '{{ constant("ingame37") }}',
					'message': data.error,
					'theme': 'error'
				});
			}else{
				showWindow('{{ constant("ingame39") }}',data.info, '440px', '118px',100 );
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$('body').on('click touchstart', '#odbierzNagrode', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "odbierzNagrode",
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
				$.fn.jAlert({
					'title': '{{ constant("ingame37") }}',
					'message': data.error,
					'theme': 'error'
				});
			}else{
				if( data.gold > 0 ){
					showWindow('{{ constant("comp_account75") }}',data.info, '440px', '118px',100 );
					playerObj.AddGold(data.gold);
				}
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	$('body').on('click touchstart', '#closeCity', function() {
		$('#cityPlane').css('display','none'); 
	});
	
	$('body').on('click touchstart', '.buildUpTB', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "buildAction",
			data     : {'bid':$(this).attr('num')},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
				if( data.doTech == 1 ){
					var ts = Math.round(new Date().getTime() / 1000| 0);
					var timeToEndSur = data.time - ts;
					loadTimer( timeToEndSur, 'buildUp'+data.bid, data.num, 5 );
					$('#buildUp'+data.bid).html(data.zegar);
					playerObj.RemoveSoftCurrency(data.cost);
					playerObj.ActMaterials(data.costMaterials);
				}else{
					showWindow('Technologia',data.error, '440px', data.height+'px',100 );
				}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	
	
	$('body').on('click touchstart', '#writeDropArea', function() {
		var that = $(this);
		if ((that.data('inprogress') || 0) == 1) { return false;}
		$.ajax({
			type     : "POST",
			dataType : "json",
			url      : "writeDropArea",
			data     : {'dz1':$('#dz1').attr('num'),'dz2':$('#dz2').attr('num'),'dz3':$('#dz3').attr('num'),'dz4':$('#dz4').attr('num'),'dz5':$('#dz5').attr('num'),'dCat':$(this).attr('num')},
			beforeSend: function() {
				that.data('inprogress', 1);
			},
		}).done(function( data ) {
			that.data('inprogress', 0);
			if (data.error)
			{
				$.fn.jAlert({
					'title': '{{ constant("ingame37") }}',
					'message': data.error,
					'theme': 'error'
				});
			}else{
				alert(data.info);
				$('#dz1').html('');
				$('#dz2').html('');
				$('#dz3').html('');
				$('#dz4').html('');
				$('#dz5').html('');
				playerObj.RemoveSoftCurrency(data.currency);
				playerObj.RemoveGold(data.gold);
				listProduction();
			}
		}).fail(function(jqXHR, textStatus, errorThrown) {
			that.data('inprogress', 0);
			alert(textStatus);
		});
	});
	$("body").append("<div id='infoTooltip'></div>");
	loadTitle();
});
        </script>
        {% block footerJS %}{% endblock %}
    </body>
</html>